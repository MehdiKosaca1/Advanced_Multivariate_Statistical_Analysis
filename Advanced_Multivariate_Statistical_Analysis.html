<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mehdi Koşaca">
<meta name="dcterms.date" content="2024-12-01">

<title>Advanced_Multivariate_Statistical_Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Advanced_Multivariate_Statistical_Analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="Advanced_Multivariate_Statistical_Analysis_files/libs/quarto-html/quarto.js"></script>
<script src="Advanced_Multivariate_Statistical_Analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="Advanced_Multivariate_Statistical_Analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Advanced_Multivariate_Statistical_Analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="Advanced_Multivariate_Statistical_Analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Advanced_Multivariate_Statistical_Analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Advanced_Multivariate_Statistical_Analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Advanced_Multivariate_Statistical_Analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Advanced_Multivariate_Statistical_Analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Advanced_Multivariate_Statistical_Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Mehdi Koşaca </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 1, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="keşifci-veri-analizi-eda" class="level1">
<h1>1) Keşifci Veri Analizi (EDA)</h1>
<section id="veri-seti-tanımı" class="level3">
<h3 class="anchored" data-anchor-id="veri-seti-tanımı">Veri Seti Tanımı</h3>
<p>Bu veri seti, Hindistan’daki birçok branşlı hastaneden alınmış olup, 1000 kişinin verilerini içermektedir. Erken aşama kalp hastalığı tespiti <strong>amacıyla toplanmıştır</strong>. Toplamda 14 <strong>farklı değişken</strong> içermektedir.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readxl' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/data_set/Cardiovascular_Dataset.csv"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  patientid age gender chestpain restingBP serumcholestrol fastingbloodsugar
1    103368  53      1         2       171               0                 0
2    119250  40      1         0        94             229                 0
3    119372  49      1         2       133             142                 0
4    132514  43      1         0       138             295                 1
5    146211  31      1         1       199               0                 0
6    148462  24      1         1       173               0                 0
  restingrelectro maxheartrate exerciseangia oldpeak slope noofmajorvessels
1               1          147             0     5.3     3                3
2               1          115             0     3.7     1                1
3               0          202             1     5.0     1                0
4               1          153             0     3.2     2                2
5               2          136             0     5.3     3                2
6               0          161             0     4.7     3                2
  target
1      1
2      0
3      0
4      1
5      1
6      1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>gender<span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>gender)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>chestpain<span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>chestpain)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>fastingbloodsugar<span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>fastingbloodsugar)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>restingrelectro<span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>restingrelectro)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>exerciseangia<span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>exerciseangia)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>slope<span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>slope)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>noofmajorvessels<span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>noofmajorvessels)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>target<span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>target)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1000 obs. of  14 variables:
 $ patientid        : int  103368 119250 119372 132514 146211 148462 168686 170498 188225 192523 ...
 $ age              : int  53 40 49 43 31 24 79 52 62 61 ...
 $ gender           : Factor w/ 2 levels "0","1": 2 2 2 2 2 2 2 2 2 1 ...
 $ chestpain        : Factor w/ 4 levels "0","1","2","3": 3 1 3 1 2 2 3 1 1 1 ...
 $ restingBP        : int  171 94 133 138 199 173 130 127 121 190 ...
 $ serumcholestrol  : int  0 229 142 295 0 0 240 345 357 181 ...
 $ fastingbloodsugar: Factor w/ 2 levels "0","1": 1 1 1 2 1 1 1 1 1 1 ...
 $ restingrelectro  : Factor w/ 3 levels "0","1","2": 2 2 1 2 3 1 3 1 2 2 ...
 $ maxheartrate     : int  147 115 202 153 136 161 157 192 138 150 ...
 $ exerciseangia    : Factor w/ 2 levels "0","1": 1 1 2 1 1 1 1 2 1 1 ...
 $ oldpeak          : num  5.3 3.7 5 3.2 5.3 4.7 2.5 4.9 2.8 2.9 ...
 $ slope            : Factor w/ 4 levels "0","1","2","3": 4 2 2 3 4 4 3 2 1 3 ...
 $ noofmajorvessels : Factor w/ 4 levels "0","1","2","3": 4 2 1 3 3 3 2 1 1 1 ...
 $ target           : Factor w/ 2 levels "0","1": 2 1 1 2 2 2 2 1 1 2 ...</code></pre>
</div>
</div>
<p>Veri setinde 1000 gözlem ve 14 değişken bulunmaktadır.</p>
</section>
<section id="değişkenler" class="level3">
<h3 class="anchored" data-anchor-id="değişkenler">Değişkenler</h3>
<ol type="1">
<li><p><strong>Patient Identification Number (<code>patientid</code>)</strong>: Hastaya özgü tanımlayıcı numara (Sayısal).</p></li>
<li><p><strong>Age (<code>age</code>)</strong>: Hastanın yaşı (Yıl cinsinden).</p></li>
<li><p><strong>Gender (<code>gender</code>)</strong>: Cinsiyet (0: Kadın, 1: Erkek).</p></li>
<li><p><strong>Resting Blood Pressure (<code>restingBP</code>)</strong>: İstirahat kan basıncı (mm Hg cinsinden).</p></li>
<li><p><strong>Serum Cholesterol (<code>serumcholestrol</code>)</strong>: Serum kolesterol seviyesi (mg/dl cinsinden).</p></li>
<li><p><strong>Fasting Blood Sugar (<code>fastingbloodsugar</code>)</strong>: Açlık kan şekeri (0: ≤120 mg/dl, 1: &gt;120 mg/dl).</p></li>
<li><p><strong>Chest Pain Type (<code>chestpain</code>)</strong>: Göğüs ağrısı türü (0: Tipik angina, 1: Atipik angina, 2: Non-anginal, 3: Asemptomatik).</p></li>
<li><p><strong>Resting Electrocardiogram Results (<code>restingelectro</code>)</strong>: Elektrokardiyografi sonucu (0: Normal, 1: ST-T dalga anormalliği, 2: Sol ventrikül hipertrofisi).</p></li>
<li><p><strong>Maximum Heart Rate Achieved (<code>maxheartrate</code>)</strong>: Elde edilen maksimum kalp hızı.</p></li>
<li><p><strong>Exercise Induced Angina (<code>exerciseangina</code>)</strong>: Egzersiz kaynaklı göğüs ağrısı (0: Hayır, 1: Evet).</p></li>
<li><p><strong>Oldpeak (<code>oldpeak</code>)</strong>: Egzersiz sonrası ST depresyonu (0-6.2 arasında).</p></li>
<li><p><strong>Slope (<code>slope</code>)</strong>: Egzersiz sonrası ST segment eğimi (1: Yükselen, 2: Yatay, 3: Düşen).</p></li>
<li><p><strong>Number of Major Vessels (<code>noofmajorvessels</code>)</strong>: Floroskopi ile görülen majör damar sayısı (0-3 arasında).</p></li>
<li><p><strong>Classification (<code>target</code>)</strong>: Kalp hastalığı durumu (0: Yok, 1: Var).</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   patientid            age        gender  chestpain   restingBP    
 Min.   : 103368   Min.   :20.00   0:235   0:420     Min.   : 94.0  
 1st Qu.:2536440   1st Qu.:34.00   1:765   1:224     1st Qu.:129.0  
 Median :4952508   Median :49.00           2:312     Median :147.0  
 Mean   :5048704   Mean   :49.24           3: 44     Mean   :151.7  
 3rd Qu.:7681877   3rd Qu.:64.25                     3rd Qu.:181.0  
 Max.   :9990855   Max.   :80.00                     Max.   :200.0  
 serumcholestrol fastingbloodsugar restingrelectro  maxheartrate  
 Min.   :  0.0   0:704             0:454           Min.   : 71.0  
 1st Qu.:235.8   1:296             1:344           1st Qu.:119.8  
 Median :318.0                     2:202           Median :146.0  
 Mean   :311.4                                     Mean   :145.5  
 3rd Qu.:404.2                                     3rd Qu.:175.0  
 Max.   :602.0                                     Max.   :202.0  
 exerciseangia    oldpeak      slope   noofmajorvessels target 
 0:502         Min.   :0.000   0:180   0:275            0:420  
 1:498         1st Qu.:1.300   1:299   1:344            1:580  
               Median :2.400   2:322   2:265                   
               Mean   :2.708   3:199   3:116                   
               3rd Qu.:4.100                                   
               Max.   :6.200                                   </code></pre>
</div>
</div>
<p>Bu çıktı, df veri setindeki değişkenlerin özet istatistiklerini ve dağılımlarını göstermektedir</p>
</section>
<section id="eksik-gözlemlerin-incelenmesi" class="level3">
<h3 class="anchored" data-anchor-id="eksik-gözlemlerin-incelenmesi">eksik gözlemlerin incelenmesi</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'naniar' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(df) <span class="sc">+</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Eksik Deger Sayıları"</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Degişkenler"</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Eksik Deger Sayısı"</span>) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Veri setinde yer alan tüm değişkenler için eksik gözlem bulunmamaktadır; her bir gözlemdeki tüm değerler eksiksizdir.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df<span class="sc">$</span>serumcholestrol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]   0 229 142 295 240 345 357 181 529 409 135 209 354 350 247 177 269 253
 [19] 397 164 223 349 352 478 521 175 248 404  86 231 241 546 326 381 417 472
 [37] 252 296 249 325 389 536 211 199 322 208 138 431 491 244 359 193 264 351
 [55] 309 176 410 328 504 561  87 433 257 508 132 316 392 221 481 261 299 236
 [73] 336 551 305 502 133 390 467 213 342 368 203 268 286 222 363 146 464 475
 [91] 230 416 353 139 495 457 137 212 517 554 306 287 537 552 318 499 310 403
[109] 239 330 278 327 385 333 413 545 166 540 445 225 179 418 498 427 378 307
[127] 398 412 534 281 428 372 300 442 547 602 337 501 503 279 373 271 466 165
[145] 254 513 415 196 476 393 439 321 465 204 407 461 396 302 436 402 220 424
[163] 277 297 379 400 289 370 505 258 260 184 174 339 343 469 194 169 335 405
[181] 172 186 515 488 237 411 272 238 250 332 134 255 168 367 470 494 276 182
[199] 386 419 282 430 266 479 331 452 347 263 197 303 463 356 489 444 420 341
[217] 432 526 319 245 267 355 214 235 338 414 408 348 334 559 487 308 497 183
[235] 601 243 358 270 292 246 535 446 492 361 180 275 438 205 201 448 522 539
[253] 313 421 198 346 376 274 371 544 280 560 520 262 242 301 291 366 178 298
[271] 429 435 553 401 284 383 324 512 234 136 523 226 406 456 484 460 207 440
[289] 483 215 486  85 200 323 329 388 265 530 477 233 314 519 437 455 375 170
[307] 471 532 273 311 459 187 377 556 304 447 555 493 283 259 288 188 191 531
[325] 340 511 256 422 228 219 251 320 506 365 185 232 527 507 195 558 480 218
[343] 384 434</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(df<span class="sc">$</span>serumcholestrol <span class="sc">==</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 53</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[df<span class="sc">$</span>serumcholestrol <span class="sc">!=</span> <span class="dv">0</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Serumcholestrol değişkeninde 0 değerleri tespit edilmiştir. Bu değerler, hatalı veya eksik gözlemler olarak değerlendirilmiş ve bu nedenle silinmiştir.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   947 obs. of  14 variables:
 $ patientid        : int  119250 119372 132514 168686 170498 188225 192523 201030 208877 223295 ...
 $ age              : int  40 49 43 79 52 62 61 59 58 27 ...
 $ gender           : Factor w/ 2 levels "0","1": 2 2 2 2 2 2 1 1 2 2 ...
 $ chestpain        : Factor w/ 4 levels "0","1","2","3": 1 3 1 3 1 1 1 2 3 1 ...
 $ restingBP        : int  94 133 138 130 127 121 190 190 192 129 ...
 $ serumcholestrol  : int  229 142 295 240 345 357 181 529 409 135 ...
 $ fastingbloodsugar: Factor w/ 2 levels "0","1": 1 1 2 1 1 1 1 2 2 1 ...
 $ restingrelectro  : Factor w/ 3 levels "0","1","2": 2 1 2 3 1 2 2 2 1 2 ...
 $ maxheartrate     : int  115 202 153 157 192 138 150 151 138 192 ...
 $ exerciseangia    : Factor w/ 2 levels "0","1": 1 2 1 1 2 1 1 2 1 2 ...
 $ oldpeak          : num  3.7 5 3.2 2.5 4.9 2.8 2.9 3.2 2.3 1 ...
 $ slope            : Factor w/ 4 levels "0","1","2","3": 2 2 3 3 2 1 3 3 4 1 ...
 $ noofmajorvessels : Factor w/ 4 levels "0","1","2","3": 2 1 3 2 1 1 1 3 2 1 ...
 $ target           : Factor w/ 2 levels "0","1": 1 1 2 2 1 1 2 2 2 1 ...</code></pre>
</div>
</div>
<p>Veri temizliği tamamlandı, 947 gözlem ve 14 değişken ile devam edilmiştir.</p>
</section>
<section id="sayısal-değişkenlerin-çarpıklık-ve-dağılımının-incelenmesi" class="level3">
<h3 class="anchored" data-anchor-id="sayısal-değişkenlerin-çarpıklık-ve-dağılımının-incelenmesi">Sayısal Değişkenlerin Çarpıklık ve Dağılımının İncelenmesi</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(df<span class="sc">$</span>restingBP, <span class="at">main =</span> <span class="st">"kan basıncı (mm Hg cinsinden)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Kutu grafiği, kan basıncının 130 ile 170 mm Hg arasında olduğunu ve medyanın yaklaşık 150 mm Hg olduğunu gösteriyor. Minimum değer yaklaşık 100 mm Hg ve maksimum değer yaklaşık 200 mm Hg’dir.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram"</span>, <span class="at">x =</span> <span class="st">"yaş"</span>, <span class="at">y =</span> <span class="st">"Gozlem sayısı"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Bu histogram, yaşların 20 ile 80 arasında değiştiğini ve en yoğun gözlemlerin 20 yaş civarında olduğunu gösteriyor. Yaş dağılımı genelde homojen, ancak genç yaşlarda daha yüksek bir yoğunluk var.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> maxheartrate)) <span class="sc">+</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"maksimum kalp hızı"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Bu yoğunluk grafiği, maksimum kalp hızının 60 ile 200 arasında değiştiğini ve en yoğun aralığın 140-160 civarında olduğunu gösteriyor. Grafikte iki belirgin tepe bulunuyor, bu da farklı grupların varlığını işaret edebilir.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> oldpeak)) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Egzersiz sonrası ST depresyonu"</span>, <span class="at">x =</span> <span class="st">"oldpeak"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Bu grafik, egzersiz sonrası ST depresyonunun çoğunlukla orta seviyelerde olduğunu, ancak bazı durumlarda daha yüksek veya daha düşük değerlerde olduğunu gösteriyor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> serumcholestrol)) <span class="sc">+</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"kolesterol seviyesi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>bu grafik, kolesterol seviyelerinin çoğunlukla 200 ile 400 arasında olduğunu ve bu aralıkta iki belirgin tepe gösterdiğini, ancak 0 ile 200 ve 400 ile 600 arasında daha az yoğunluk gösterdiğini göstermektedir</p>
<section id="sayısal-değişkenlerin-çarpıklık-durumunun-detaylı-incelenmesi" class="level4">
<h4 class="anchored" data-anchor-id="sayısal-değişkenlerin-çarpıklık-durumunun-detaylı-incelenmesi">Sayısal Değişkenlerin Çarpıklık Durumunun Detaylı İncelenmesi</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'e1071' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>numerical_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"restingBP"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>, <span class="st">"oldpeak"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Çarpıklık hesaplama</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>skewness_results <span class="ot">&lt;-</span> <span class="fu">sapply</span>(df[, numerical_vars], skewness)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Çarpıklık sonuçlarını yazdırma</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(skewness_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            age       restingBP serumcholestrol    maxheartrate         oldpeak 
     0.02296224      0.06475853      0.18442465     -0.23984345      0.29855532 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># En çarpık değişkeni bulma</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>most_skewed <span class="ot">&lt;-</span> <span class="fu">names</span>(skewness_results)[<span class="fu">which.max</span>(<span class="fu">abs</span>(skewness_results))]</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"En carpık değişken:"</span>, most_skewed, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>En carpık değişken: oldpeak </code></pre>
</div>
</div>
<ul>
<li><p><strong>age</strong>: 0.02296 – Bu, yaş değişkeninin normal dağılıma yakın olduğunu gösterir. Çarpıklık değeri çok düşük, bu da simetrik bir dağılımı işaret eder.</p></li>
<li><p><strong>restingBP</strong>: 0.06476 – İstirahat kan basıncı da benzer şekilde çok düşük bir çarpıklığa sahip, bu da dağılımın simetrik olduğuna işaret eder.</p></li>
<li><p><strong>serumcholestrol</strong>: 0.18442 – Serum kolesterol seviyesi için çarpıklık biraz daha yüksek, ancak hala oldukça düşük bir değer. Dağılımda hafif bir sağ çarpıklık olabilir.</p></li>
<li><p><strong>maxheartrate</strong>: -0.23984 – Maksimum kalp hızı değişkeninin çarpıklığı negatif, bu da verinin sağa kıyasla daha çok sola çarpık olduğunu ve yüksek kalp hızı değerlerinin daha az sıklıkta olduğunu gösterebilir.</p></li>
<li><p><strong>oldpeak</strong>: 0.29856 – Egzersiz sonrası ST depresyonu değişkeni de pozitif çarpıklığa sahip ve bu, verinin sağa çarpık olduğunu, yani düşük değerlerin daha yaygın olduğunu gösterir.</p></li>
</ul>
</section>
</section>
<section id="kategorik-değişkenlerin-incelenmesi" class="level3">
<h3 class="anchored" data-anchor-id="kategorik-değişkenlerin-incelenmesi">Kategorik değişkenlerin incelenmesi</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gerekli kütüphaneler</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra) <span class="co"># Birden fazla grafiği düzenlemek için</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gridExtra' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kategorik değişkenler</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>categorical_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gender"</span>, <span class="st">"fastingbloodsugar"</span>, <span class="st">"chestpain"</span>, <span class="st">"restingrelectro"</span>, <span class="st">"exerciseangia"</span>, <span class="st">"slope"</span>, <span class="st">"noofmajorvessels"</span>, <span class="st">"target"</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar grafiklerini oluştur ve ikili gruplar halinde göster</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(categorical_vars), <span class="at">by =</span> <span class="dv">2</span>)) {</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># İkişerli grup</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  vars <span class="ot">&lt;-</span> categorical_vars[i<span class="sc">:</span><span class="fu">min</span>(i <span class="sc">+</span> <span class="dv">1</span>, <span class="fu">length</span>(categorical_vars))]</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grafik oluşturma</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  plots <span class="ot">&lt;-</span> <span class="fu">lapply</span>(vars, <span class="cf">function</span>(var) {</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(df, <span class="fu">aes_string</span>(<span class="at">x =</span> var)) <span class="sc">+</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Frekans Dağılımı:"</span>, var), <span class="at">x =</span> var, <span class="at">y =</span> <span class="st">"Frekans"</span>) <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grafikleri yan yana düzenle</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid.arrange</span>(<span class="at">grobs =</span> plots, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
ℹ Please use tidy evaluation idioms with `aes()`.
ℹ See also `vignette("ggplot2-in-packages")` for more information.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-18-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-18-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>gender (cinsiyet):</strong> Veri kümesi <strong>erkek</strong> ağırlıklı.</p></li>
<li><p><strong>fastingbloodsugar (açlık kan şekeri):</strong> Çoğunluğun açlık kan şekeri seviyeleri 120 mg/dl ve altında. 120 mg/dl’nin üzerinde olanlar daha az yaygın.</p></li>
<li><p><strong>chestpain (göğüs ağrısı):</strong> Tipik angina, diğer göğüs ağrısı türlerine göre daha sık görülüyor. Asemptomatik göğüs ağrısı en az yaygın olanı.</p></li>
<li><p><strong>restingelectro (dinlenme EKG’si):</strong> Normal dinlenme EKG sonuçları baskın. ST-T dalgası anormallikleri ve sol ventrikül hipertrofisi daha az görülüyor.</p></li>
<li><p><strong>exerciseangina (egzersiz anjini):</strong> Veri setinde, egzersizle tetiklenen anjina ve egzersizle tetiklenmeyen anjina vakaları neredeyse eşit sayıda dağılmış.</p></li>
<li><p><strong>slope (eğim/ST segment eğimi):</strong> Yükselen ST segmenti, diğer eğim türlerine göre en yaygın olanı. Yatay eğim ikinci sırada, düşen eğim ise en az yaygın.</p></li>
<li><p><strong>noofmajorvessels (floroskopi ile görülen majör damar sayısı):</strong> Floroskopi ile tespit edilen majör damar sayısı düşük olan kişiler daha yaygın. Üç damarlı kişiler daha az görülüyor.</p></li>
<li><p><strong>target (hedef değişken - kalp hastalığı):</strong> Kalp hastalığı olanların sayısı, olmayanlara göre biraz daha fazla, bu da veri kümesinde hafif bir dengesizlik olduğunu gösteriyor.</p></li>
</ul>
</section>
</section>
<section id="manova" class="level1">
<h1>2) Manova</h1>
<section id="multivariate-normality" class="level3">
<h3 class="anchored" data-anchor-id="multivariate-normality">Multivariate Normality</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(dplyr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dplyr' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(rstatix))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'rstatix' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(maxheartrate,serumcholestrol,restingBP,age) <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mshapiro_test</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  statistic p.value
      &lt;dbl&gt;   &lt;dbl&gt;
1     0.997  0.0544</code></pre>
</div>
</div>
<ul>
<li><p><strong>H0 (Sıfır Hipotezi):</strong> age,maxheartrate, serumcholestrol ve restingBP değişkenleri normal dağılmıştır.</p></li>
<li><p><strong>H1 (Alternatif Hipotez):</strong> age,maxheartrate, serumcholestrol ve restingBP değişkenlerinden en az biri normal dağılmamıştır</p>
<p><strong>Yorum:</strong></p>
<p>Shapiro-Wilk testi sonucunda p-değeri çok düşük ( 0.05442 &gt; 0.05) <strong>H0 reddedilemez</strong>. Bu da şu anlama gelir:</p>
<p><strong>H0 reddedilemez</strong>: age,maxheartrate, serumcholestrol ve restingBP değişkenlerinin normal dağıldığı varsayımını reddetmek için yeterli kanıt olmadığı anlamına gelir.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sayısal değişkenlerin isimleri</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>numeric_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"restingBP"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>, <span class="st">"oldpeak"</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Shapiro-Wilk testi uygulama fonksiyonu</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>shapiro_test_results <span class="ot">&lt;-</span> <span class="cf">function</span>(df, vars) {</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (var <span class="cf">in</span> vars) {</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    test_result <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(df[[var]])  <span class="co"># Shapiro-Wilk testi</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Değişken:"</span>, var, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Test istatistiği:"</span>, test_result<span class="sc">$</span>statistic, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"p-değeri:"</span>, test_result<span class="sc">$</span>p.value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro_test_results</span>(df, numeric_vars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Değişken: age 
Test istatistiği: 0.9497066 
p-değeri: 1.895357e-17 

Değişken: restingBP 
Test istatistiği: 0.9458878 
p-değeri: 3.984672e-18 

Değişken: serumcholestrol 
Test istatistiği: 0.9830354 
p-değeri: 4.905516e-09 

Değişken: maxheartrate 
Test istatistiği: 0.9671685 
p-değeri: 8.831148e-14 

Değişken: oldpeak 
Test istatistiği: 0.9572532 
p-değeri: 5.396876e-16 </code></pre>
</div>
</div>
<section id="targethedef-değişken---kalp-hastalığı-için" class="level4">
<h4 class="anchored" data-anchor-id="targethedef-değişken---kalp-hastalığı-için">Target(hedef değişken - kalp hastalığı) için:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(gplots))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gplots' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmeans</span>(restingBP <span class="sc">~</span> target, <span class="at">xlab=</span><span class="st">"target"</span>, <span class="at">ylab=</span><span class="st">"restingBP"</span>, <span class="at">main=</span><span class="st">"Mean Plot</span><span class="sc">\n</span><span class="st">with 95% CI"</span>, <span class="at">data=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmeans</span>(age <span class="sc">~</span> target, <span class="at">xlab=</span><span class="st">"target"</span>, <span class="at">ylab=</span><span class="st">"age"</span>, <span class="at">main=</span><span class="st">"Mean Plot</span><span class="sc">\n</span><span class="st">with 95% CI"</span>, <span class="at">data=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmeans</span>(maxheartrate <span class="sc">~</span> target, <span class="at">xlab=</span><span class="st">"target"</span>, <span class="at">ylab=</span><span class="st">"maxheart rate"</span>, <span class="at">main=</span><span class="st">"Mean Plot</span><span class="sc">\n</span><span class="st">with 95% CI"</span>, <span class="at">data=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-21-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmeans</span>(serumcholestrol <span class="sc">~</span> target, <span class="at">xlab=</span><span class="st">"target"</span>, <span class="at">ylab=</span><span class="st">"maxheart rate"</span>, <span class="at">main=</span><span class="st">"Mean Plot</span><span class="sc">\n</span><span class="st">with 95% CI"</span>, <span class="at">data=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-21-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="restingrelectrodinlenme-ekgsi-için" class="level4">
<h4 class="anchored" data-anchor-id="restingrelectrodinlenme-ekgsi-için">restingrelectro(dinlenme EKG’si) için:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmeans</span>(restingBP <span class="sc">~</span> restingrelectro, <span class="at">xlab=</span><span class="st">"restingrelectro"</span>, <span class="at">ylab=</span><span class="st">"restingBP"</span>, <span class="at">main=</span><span class="st">"Mean Plot</span><span class="sc">\n</span><span class="st">with 95% CI"</span>, <span class="at">data=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmeans</span>(age <span class="sc">~</span> restingrelectro, <span class="at">xlab=</span><span class="st">"restingrelectro"</span>, <span class="at">ylab=</span><span class="st">"age"</span>, <span class="at">main=</span><span class="st">"Mean Plot</span><span class="sc">\n</span><span class="st">with 95% CI"</span>, <span class="at">data=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmeans</span>(maxheartrate <span class="sc">~</span> restingrelectro, <span class="at">xlab=</span><span class="st">"restingrelectro"</span>, <span class="at">ylab=</span><span class="st">"max heart rate"</span>, <span class="at">main=</span><span class="st">"Mean Plot</span><span class="sc">\n</span><span class="st">with 95% CI"</span>, <span class="at">data=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-22-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmeans</span>(serumcholestrol <span class="sc">~</span> restingrelectro, <span class="at">xlab=</span><span class="st">"restingrelectro"</span>, <span class="at">ylab=</span><span class="st">"maxheart rate"</span>, <span class="at">main=</span><span class="st">"Mean Plot</span><span class="sc">\n</span><span class="st">with 95% CI"</span>, <span class="at">data=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-22-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="homogeneity-of-covariances" class="level3">
<h3 class="anchored" data-anchor-id="homogeneity-of-covariances">Homogeneity of Covariances</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(biotools)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'biotools' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Zorunlu paket yükleniyor: MASS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:rstatix':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>---
biotools version 4.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">box_m</span>(df[, <span class="fu">c</span>( <span class="st">"maxheartrate"</span>,<span class="st">"serumcholestrol"</span>,<span class="st">"restingBP"</span>,<span class="st">"age"</span>)], df<span class="sc">$</span>target)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  statistic  p.value parameter method                                           
      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                                            
1      101. 3.84e-17        10 Box's M-test for Homogeneity of Covariance Matri…</code></pre>
</div>
</div>
<p><strong>Hipotezler:</strong></p>
<ul>
<li><p><strong>H0 (Sıfır Hipotezi):</strong> Gruplara ait kovaryans matrisleri eşittir (homojenlik vardır).</p></li>
<li><p><strong>H1 (Alternatif Hipotez):</strong> Gruplara ait kovaryans matrisleri eşit değildir (homojenlik yoktur).</p></li>
</ul>
<p><strong>Yorum:</strong></p>
<p><strong>p-value = 0.95397</strong>, 0.05’ten büyük olduğu için(<strong>3.83 × 10⁻¹⁷&lt;0.05=a)</strong> <strong>H0 reddedilir</strong>. Bu durumda, gruplara ait kovaryans matrislerinin eşit olmadığı (homojenlik varsayımının sağlandığı) sonucuna varılır.</p>
</section>
<section id="tek-yönlü-manova" class="level3">
<h3 class="anchored" data-anchor-id="tek-yönlü-manova">Tek Yönlü Manova</h3>
<ul>
<li><strong>restingrelectro</strong>(hedef) değişkeninin <strong>maxheartrate</strong> (maksimum kalp atış hızı), <strong>serumcholestrol</strong> (serum kolesterol), <strong>restingBP</strong> (dinlenik kan basıncı) ve <strong>age</strong> (yaş) üzerindeki etkilerini incelemektedir. Bu analiz, <strong>restingrelectro’ın</strong> bu sağlık parametreleri üzerindeki çoklu etkilerini değerlendirmeyi amaçlamaktadır.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>manova_df <span class="ot">&lt;-</span> <span class="fu">manova</span>(<span class="fu">cbind</span>(maxheartrate,serumcholestrol,restingBP,age) <span class="sc">~</span> restingrelectro,<span class="at">data=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># car paketi</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'car' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Zorunlu paket yükleniyor: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'carData' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>model22 <span class="ot">&lt;-</span> <span class="fu">glm</span>(restingrelectro <span class="sc">~</span> restingBP <span class="sc">+</span> serumcholestrol <span class="sc">+</span> age <span class="sc">+</span> maxheartrate, </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> df, </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="co"># VIF </span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(model22)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      restingBP serumcholestrol             age    maxheartrate 
       1.039514        1.037446        1.004514        1.011443 </code></pre>
</div>
</div>
<p>Modeldeki bağımsız değişkenler arasındaki düşük korelasyon (VIF değerleri 1’e yakın) çoklu bağlantı sorununun olmadığını ve restingrelectro bağımlı değişkenin doğru bir şekilde tahmin edilebileceğini gösteriyor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(manova_df, <span class="at">test =</span> <span class="st">"Hotelling-Lawley"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Df Hotelling-Lawley approx F num Df den Df    Pr(&gt;F)    
restingrelectro   2         0.090189   10.597      8   1880 1.185e-14 ***
Residuals       944                                                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>Hipotezler:</strong></p>
<ul>
<li><p><strong>H0 (Sıfır Hipotezi):</strong> restingrelectro değişkeninin bağımlı değişkenler üzerinde anlamlı bir etkisi yoktur.</p></li>
<li><p><strong>H1 (Alternatif Hipotezi):</strong> restingrelectro değişkeninin bağımlı değişkenler üzerinde anlamlı bir etkisi vardır.</p></li>
</ul>
<p><strong>p-değeri ( 1.185e-14)</strong> Çok küçük olduğu için <strong>( 1.185e-14 &lt; 0.05=a)</strong> , <strong>H0 reddedilir</strong>. Bu, restingrelectro değişkeninin bağımlı değişkenler üzerinde anlamlı bir etkisi olduğunu güçlü bir şekilde destekler.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>( <span class="fu">c</span>(maxheartrate,serumcholestrol,restingBP,age),<span class="at">names_to =</span> <span class="st">"variable"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(value <span class="sc">~</span> restingrelectro ,<span class="at">center=</span>mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  variable          df1   df2 statistic       p
  &lt;chr&gt;           &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 age                 2   944      2.31 0.0997 
2 maxheartrate        2   944      6.39 0.00174
3 restingBP           2   944      4.02 0.0183 
4 serumcholestrol     2   944      1.92 0.147  </code></pre>
</div>
</div>
<p><strong>Hipotez</strong></p>
<ul>
<li><p><strong>H₀ :</strong> gruplar arasında varyans eşittir.</p></li>
<li><p><strong>H₁ :</strong> gruplar arasında varyans eşit değildir.</p></li>
</ul>
<p><strong>Değişken Bazında Yorum:</strong></p>
<ol type="1">
<li><p><strong>age:</strong></p>
<ul>
<li>(p=0.997&gt; 0.05 =a) <strong>H0 reddedilemez</strong> Gruplar arasında varyanslar <strong>eşittir</strong>.</li>
</ul></li>
<li><p><strong>maxheartrate:</strong></p>
<ul>
<li>(p=0.0017&lt; 0.05 =a) <strong>H0 reddedilir</strong>Gruplar arasında varyanslar <strong>eşit değildir</strong>.</li>
</ul></li>
<li><p><strong>restingBP:</strong></p>
<ul>
<li>(p=0.0183&lt; 0.05 =a) <strong>H0 reddedilir</strong>Gruplar arasında varyanslar <strong>eşit değildir</strong>.</li>
</ul></li>
<li><p><strong>serumcholestrol:</strong></p>
<ul>
<li><p>(p=0.1469&gt; 0.05 =a) <strong>H0 reddedilemez</strong> Gruplar arasında varyanslar <strong>eşittir</strong>.</p>
<h3 id="test-of-between-subjects" class="anchored">Test of Between Subjects</h3></li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(manova_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Response maxheartrate :
                 Df  Sum Sq Mean Sq F value   Pr(&gt;F)   
restingrelectro   2   12575  6287.7  5.3386 0.004949 **
Residuals       944 1111820  1177.8                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response serumcholestrol :
                 Df   Sum Sq Mean Sq F value    Pr(&gt;F)    
restingrelectro   2   449048  224524  18.199 1.757e-08 ***
Residuals       944 11646092   12337                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response restingBP :
                 Df Sum Sq Mean Sq F value   Pr(&gt;F)    
restingrelectro   2  42899 21449.6  24.924 2.83e-11 ***
Residuals       944 812415   860.6                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response age :
                 Df Sum Sq Mean Sq F value  Pr(&gt;F)  
restingrelectro   2   1547  773.25   2.424 0.08912 .
Residuals       944 301135  319.00                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>1.maxheartrate (Maksimum Kalp Hızı):</strong></p>
<ul>
<li><p><strong>p-değeri:</strong> 0.0049</p></li>
<li><p><strong>Yorum:</strong> p-değeri 0.05’ten küçük (<strong>p &lt; 0.05</strong>), bu nedenle <strong>H₀ hipotezi reddedilir</strong>. Yani, “restingrelectro” (kalp hastalığı durumu) ile maksimum kalp hızı arasında anlamlı bir ilişki vardır.</p></li>
</ul>
<p><strong>2. serumcholestrol (Serum Kolesterol Seviyesi):</strong></p>
<ul>
<li><p><strong>p-değeri:</strong> &lt; 1.757e-08</p></li>
<li><p><strong>Yorum:</strong> p-değeri 0.05’ten küçük (<strong>p &lt; 0.05</strong>), bu nedenle <strong>H₀ hipotezi reddedilir</strong>. Yani, “restingrelectro” (kalp hastalığı durumu) ile serum kolesterol seviyesi arasında anlamlı bir ilişki vardır.</p></li>
</ul>
<p><strong>3. restingBP (İstirahat Kan Basıncı):</strong></p>
<ul>
<li><p><strong>p-değeri:</strong> &lt; 2.83e-11</p></li>
<li><p><strong>Yorum:</strong> p-değeri 0.05’ten küçük (<strong>p &lt; 0.05</strong>), bu nedenle <strong>H₀ hipotezi reddedilir</strong>. Yani, “restingrelectro” (kalp hastalığı durumu) ile istirahat kan basıncı arasında anlamlı bir ilişki vardır.</p></li>
</ul>
<p><strong>4. age (Yaş):</strong></p>
<ul>
<li><p><strong>p-değeri:</strong> 0.08912</p></li>
<li><p><strong>Yorum:</strong> p-değeri 0.05’ten büyük (<strong>p &gt; 0.05</strong>), bu nedenle <strong>H₀ hipotezi reddedilemez</strong>. Yani, yaş değişkeninin “restingrelectro” (kalp hastalığı durumu) üzerinde anlamlı bir etkisi yoktur.</p>
<h3 id="tukey-testi" class="anchored">Tukey testi</h3></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>m_tukey2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>( <span class="fu">c</span>(age,serumcholestrol),<span class="at">names_to =</span> <span class="st">"variables"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variables) <span class="sc">%&gt;%</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tukey_hsd</span>(value <span class="sc">~</span> restingrelectro)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>m_tukey2<span class="ot">&lt;-</span>m_tukey2[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>)]</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>m_tukey2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
  variables       group2 group1 estimate conf.low conf.high   p.adj p.adj.signif
  &lt;chr&gt;           &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;       
1 age             1      0         2.15    -0.921      5.22 2.28e-1 ns          
2 age             2      0         3.06    -0.620      6.74 1.25e-1 ns          
3 age             2      1         0.912   -2.96       4.78 8.45e-1 ns          
4 serumcholestrol 1      0        26.0      6.91      45.1  4.1 e-3 **          
5 serumcholestrol 2      0        57.7     34.8       80.6  1.37e-8 ****        
6 serumcholestrol 2      1        31.7      7.64      55.8  5.78e-3 **          </code></pre>
</div>
</div>
<p>Hipotez</p>
<ul>
<li><p><strong>H₀ :</strong> gruplar arasında anlamlı bir fark yoktur.</p></li>
<li><p><strong>H₁ :</strong> gruplar arasında anlamlı bir fark vardır.</p>
<h4 id="değişken-bazında-yorum" class="anchored">Değişken Bazında Yorum:</h4></li>
<li><p><strong>Yaş</strong> değişkeni için <strong>H0</strong> <strong>reddedilir.</strong> (p-değerleri &lt; 0.05=a).</p></li>
<li><p><strong>Serum Kolesterol</strong> değişkeni için <strong>H0</strong> <strong>reddedilir.</strong> (p-değerleri &lt;0.05=a), bu da gruplar arasında anlamlı bir fark olduğunu gösterir.</p></li>
</ul>
</section>
<section id="levene--not-equal-variances---games-howell" class="level3">
<h3 class="anchored" data-anchor-id="levene--not-equal-variances---games-howell">Levene- Not equal variances - Games Howell</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>games_howell<span class="ot">&lt;-</span><span class="fu">games_howell_test</span>(df,age <span class="sc">~</span> restingrelectro)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>games_howell</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 8
  .y.   group1 group2 estimate conf.low conf.high p.adj p.adj.signif
* &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;       
1 age   0      1         2.15    -0.892      5.19 0.221 ns          
2 age   0      2         3.06    -0.669      6.79 0.131 ns          
3 age   1      2         0.912   -2.93       4.76 0.842 ns          </code></pre>
</div>
</div>
<p>Hipotez</p>
<ul>
<li><p><strong>H₀ :</strong> gruplar arasında anlamlı bir fark yoktur.</p></li>
<li><p><strong>H₁ :</strong> gruplar arasında anlamlı bir fark vardır.</p></li>
</ul>
<p><strong>p-değerleri &gt;</strong> 0.05 olduğu için <strong>H0</strong> <strong>reddedilemez</strong>. Yani, yaş değişkeni açısından gruplar arasında anlamlı bir fark olmadığı sonucuna varılabilir.</p>
</section>
<section id="çift-yönlü-manova" class="level3">
<h3 class="anchored" data-anchor-id="çift-yönlü-manova">Çift Yönlü Manova</h3>
<ul>
<li><strong>restingelectro ve chestpain düzeylerinin restingBP, serumcholestrol ve age üzerindeki etkilerini incelemektedir.</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(heplots)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'heplots' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Zorunlu paket yükleniyor: broom</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'broom' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'heplots'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:biotools':

    boxM</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxM</span>( <span class="fu">cbind</span>(restingBP,serumcholestrol,age) <span class="sc">~</span> restingrelectro<span class="sc">*</span>chestpain , <span class="at">data=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box's M-test for Homogeneity of Covariance Matrices

data:  Y
Chi-Sq (approx.) = 126.14, df = 66, p-value = 1.197e-05</code></pre>
</div>
</div>
<p>Hipotez</p>
<ul>
<li><p><strong>H₀ :</strong> Varyans Kovaryans matrisleri homojendir.</p></li>
<li><p><strong>H₁ :</strong> Varyans Kovaryans matrisleri homojen değildir.</p></li>
</ul>
<p>p-değeri <strong>1.197e-05 &lt; 0.05 Ho Reddedilir yani</strong> Varyans Kovaryans matrisleri homojen olduğu söylenemez.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>df_cift <span class="ot">&lt;-</span> <span class="fu">manova</span>(<span class="fu">cbind</span>(restingBP,serumcholestrol,age) <span class="sc">~</span> restingrelectro<span class="sc">*</span>chestpain,<span class="at">data=</span>df)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df_cift, <span class="at">test =</span> <span class="st">"Wilks"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           Df   Wilks approx F num Df den Df    Pr(&gt;F)    
restingrelectro             2 0.91171  14.7113      6 1866.0 &lt; 2.2e-16 ***
chestpain                   3 0.86183  15.8966      9 2270.8 &lt; 2.2e-16 ***
restingrelectro:chestpain   6 0.95168   2.5905     18 2639.4 0.0002627 ***
Residuals                 935                                             
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Hipotez</p>
<ul>
<li><p><strong>H₀ :</strong> <strong>restingelectro ve chestpain</strong> etkileşiminin restingBP, serumcholestrol ve age üzerinde etkisi yoktur.</p></li>
<li><p><strong>H₁ :</strong> <strong>restingelectro ve chestpain</strong> etkileşiminin restingBP, serumcholestrol ve age üzerinde etkisi vardır.</p></li>
</ul>
<p><strong>p-değeri = 0.00026</strong>: <strong>H₀</strong> reddedilir, çünkü p-değeri 0.05’ten küçük. Bu, <strong>restingelectro ve chestpain</strong> arasındaki etkileşimin bağımlı değişkenler üzerinde anlamlı bir etkinin olduğunu gösterir.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Partial Eta Squared Hesaplamak İçin</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">etasq</span>(df_cift, <span class="at">test=</span><span class="st">"Wilks"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                               eta^2
restingrelectro           0.02629047
chestpain                 0.04835711
restingrelectro:chestpain 0.01637501</code></pre>
</div>
</div>
<ul>
<li><p><strong>exerciseangia</strong>: <strong>0.026</strong> (çok küçük, anlamlı etki yok)</p></li>
<li><p><strong>fastingbloodsugar</strong>: <strong>0.0453</strong> (önemli, anlamlı etki var)</p></li>
<li><p><strong>exerciseangia:fastingbloodsugar</strong>: <strong>0.016</strong> (çok küçük, anlamlı etki yok)</p></li>
</ul>
<!-- -->
<ul>
<li><strong>exerciseangia ve</strong> <strong>fastingbloodsugar</strong> değişkenleri düşük etkiye sahiptir.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Homogeneity of variance- Levene's Test</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>( <span class="fu">c</span>(restingBP,serumcholestrol,age),<span class="at">names_to =</span> <span class="st">"variable"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(value <span class="sc">~</span> restingrelectro<span class="sc">*</span>chestpain ,<span class="at">center=</span>mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  variable          df1   df2 statistic        p
  &lt;chr&gt;           &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 age                11   935      1.40 1.65e- 1
2 restingBP          11   935      9.66 1.08e-16
3 serumcholestrol    11   935      2.61 2.76e- 3</code></pre>
</div>
</div>
<ul>
<li><p><strong>age</strong>: p = 1.65e-01 (Anlamlı, varyanslar eşit değil)</p></li>
<li><p><strong>restingBP</strong>: p = 1.07e-16(Anlamlı, varyanslar eşit değil)</p></li>
<li><p><strong>serumcholestrol</strong>: p = 2.75e-03 (Anlamlı, varyanslar eşit değil)</p></li>
</ul>
<p><strong>age, serumcholestrol vee restingBP</strong> için varyanslar eşit değil.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Test of Between Subjects</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(df_cift)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Response restingBP :
                           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
restingrelectro             2  42899 21449.6 28.5871 8.904e-13 ***
chestpain                   3  86351 28783.7 38.3616 &lt; 2.2e-16 ***
restingrelectro:chestpain   6  24508  4084.7  5.4439 1.511e-05 ***
Residuals                 935 701555   750.3                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response serumcholestrol :
                           Df   Sum Sq Mean Sq F value    Pr(&gt;F)    
restingrelectro             2   449048  224524 19.2179 6.618e-09 ***
chestpain                   3   526686  175562 15.0271 1.472e-09 ***
restingrelectro:chestpain   6   195758   32626  2.7926   0.01069 *  
Residuals                 935 10923648   11683                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response age :
                           Df Sum Sq Mean Sq F value  Pr(&gt;F)  
restingrelectro             2   1547  773.25  2.4066 0.09068 .
chestpain                   3    250   83.23  0.2590 0.85491  
restingrelectro:chestpain   6    469   78.08  0.2430 0.96210  
Residuals                 935 300417  321.30                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">etasq</span>(<span class="fu">aov</span>(restingBP<span class="sc">~</span>restingrelectro<span class="sc">*</span>chestpain, <span class="at">data=</span>df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          Partial eta^2
restingrelectro              0.03508962
chestpain                    0.10959579
restingrelectro:chestpain    0.03375514
Residuals                            NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">etasq</span>(<span class="fu">aov</span>(serumcholestrol<span class="sc">~</span>restingrelectro<span class="sc">*</span>chestpain, <span class="at">data=</span>df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          Partial eta^2
restingrelectro              0.01931343
chestpain                    0.04599741
restingrelectro:chestpain    0.01760510
Residuals                            NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">etasq</span>(<span class="fu">aov</span>(age<span class="sc">~</span>restingrelectro<span class="sc">*</span>chestpain, <span class="at">data=</span>df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          Partial eta^2
restingrelectro             0.004149522
chestpain                   0.000830473
restingrelectro:chestpain   0.001557093
Residuals                            NA</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Çoklu Karsilastirmalar (Multiple Comparisons)</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="co"># exerciseangia icin</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>m_tukey22 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>( <span class="fu">c</span>(restingBP,serumcholestrol,age),<span class="at">names_to =</span> <span class="st">"variables"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variables) <span class="sc">%&gt;%</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tukey_hsd</span>(value <span class="sc">~</span> restingrelectro<span class="sc">*</span>chestpain)</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>m_tukey22<span class="ot">&lt;-</span>m_tukey22[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>)]</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>exerciseangia_etk<span class="ot">&lt;-</span><span class="fu">filter</span>(m_tukey22, term<span class="sc">==</span><span class="st">"exerciseangia"</span>)</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>exerciseangia_etk</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 9
# ℹ 9 variables: variables &lt;chr&gt;, term &lt;chr&gt;, group2 &lt;chr&gt;, group1 &lt;chr&gt;,
#   estimate &lt;dbl&gt;, conf.low &lt;dbl&gt;, conf.high &lt;dbl&gt;, p.adj &lt;dbl&gt;,
#   p.adj.signif &lt;chr&gt;</code></pre>
</div>
</div>
<ul>
<li>P değerleri tüm değişkenler için 0.05’ten büyük ,exerciseangia (muhtemelen egzersiz anginası durumu) bu değişkenlerin her biri üzerinde anlamlı bir etkiye sahip değildir.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">#exerciseangia ve fastingbloodsugar için Etkilesim Grafikleri (Interaction Plots) </span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(df)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction.plot</span>(restingrelectro,chestpain,restingBP, <span class="at">fun=</span>mean, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">legend=</span><span class="cn">TRUE</span>,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction.plot</span>(restingrelectro,chestpain,serumcholestrol, <span class="at">fun=</span>mean, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">legend=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-38-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction.plot</span>(restingrelectro,chestpain,age, <span class="at">fun=</span>mean, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">legend=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-38-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Etkileşim grafikleri,&nbsp;exerciseangia&nbsp;(egzersize bağlı anjina) ve&nbsp;fastingbloodsugar&nbsp;(açlık kan şekeri) faktörlerinin, yaş ve dinlenik kan basıncı değişkenleri üzerinde etkileşim içinde olduğunu göstermektedir. Yani, bu değişkenler üzerindeki etkileri, bu iki faktörün kombinasyonuna göre değişmektedir. Serum kolesterol için ise, etkileşim oldukça zayıf görünmektedir.</li>
</ul>
</section>
</section>
<section id="pcatemel-bileşenler-analizi" class="level1">
<h1><strong>3) PCA(Temel Bileşenler Analizi)</strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Korelasyon </span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PerformanceAnalytics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'PerformanceAnalytics' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Zorunlu paket yükleniyor: xts</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'xts' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Zorunlu paket yükleniyor: zoo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'zoo'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
######################### Warning from 'xts' package ##########################
#                                                                             #
# The dplyr lag() function breaks how base R's lag() function is supposed to  #
# work, which breaks lag(my_xts). Calls to lag(my_xts) that you type or       #
# source() into this session won't work correctly.                            #
#                                                                             #
# Use stats::lag() to make sure you're not using dplyr::lag(), or you can add #
# conflictRules('dplyr', exclude = 'lag') to your .Rprofile to stop           #
# dplyr from breaking base R's lag() function.                                #
#                                                                             #
# Code in packages is not affected. It's protected by R's namespace mechanism #
# Set `options(xts.warn_dplyr_breaks_lag = FALSE)` to suppress this warning.  #
#                                                                             #
###############################################################################</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'xts'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    first, last</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'PerformanceAnalytics'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:gplots':

    textplot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:e1071':

    kurtosis, skewness</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    legend</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chart.Correlation</span>(df[,<span class="fu">c</span>(<span class="st">"restingBP"</span>,<span class="st">"age"</span>,<span class="st">"oldpeak"</span>,<span class="st">"serumcholestrol"</span>,<span class="st">"maxheartrate"</span>)], <span class="at">histogram=</span><span class="cn">TRUE</span>, <span class="at">pch=</span><span class="dv">19</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'corrplot' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.95 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(df[,<span class="fu">c</span>(<span class="st">"restingBP"</span>,<span class="st">"age"</span>,<span class="st">"oldpeak"</span>,<span class="st">"serumcholestrol"</span>,<span class="st">"maxheartrate"</span>)]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'Hmisc' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Hmisc'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    src, summarize</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:e1071':

    impute</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    format.pval, units</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pearson korelasyon matrisini hesaplama</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rcorr</span>(<span class="fu">as.matrix</span>(df[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"age"</span>, <span class="st">"oldpeak"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>)]), <span class="at">type =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                restingBP   age oldpeak serumcholestrol maxheartrate
restingBP            1.00 -0.01   -0.02            0.22         0.10
age                 -0.01  1.00   -0.03            0.03        -0.04
oldpeak             -0.02 -0.03    1.00           -0.02         0.04
serumcholestrol      0.22  0.03   -0.02            1.00         0.09
maxheartrate         0.10 -0.04    0.04            0.09         1.00

n= 947 


P
                restingBP age    oldpeak serumcholestrol maxheartrate
restingBP                 0.7027 0.6158  0.0000          0.0031      
age             0.7027           0.4326  0.2933          0.2083      
oldpeak         0.6158    0.4326         0.5263          0.1968      
serumcholestrol 0.0000    0.2933 0.5263                  0.0072      
maxheartrate    0.0031    0.2083 0.1968  0.0072                      </code></pre>
</div>
</div>
<ul>
<li><p><strong>restingBP</strong> ve <strong>serumcholestrol</strong> arasında <strong>0.22</strong>’lik pozitif bir korelasyon bulunuyor. Bu ilişki düşük, ancak yine de bir miktar ilişki var.</p></li>
<li><p><strong>restingBP</strong> ve <strong>maxheartrate</strong> arasında <strong>0.10</strong>’luk zayıf bir ilişki var.</p></li>
<li><p><strong>age</strong>, <strong>oldpeak</strong>, ve <strong>serumcholestrol</strong> arasındaki korelasyonlar oldukça düşük, 0.03 ile 0.5263 arasında değişiyor. Bu, bu değişkenlerin birbirlerinden bağımsız olduklarını gösterir.</p></li>
<li><p><strong>serumcholestrol</strong> ile <strong>oldpeak</strong> arasındaki korelasyon <strong>-0.02</strong> olarak oldukça düşük, yani bu iki değişken arasında çok az bir ilişki var.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Korelasyon Matrisinin Determinantı</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">det</span>(<span class="fu">cor</span>(df[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"age"</span>, <span class="st">"oldpeak"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>)]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9318161</code></pre>
</div>
</div>
<p>Korelasyon matrisinin determinantı <strong>0.9318</strong> gibi yüksek bir değere sahip olduğu için, veri setindeki değişkenlerin çoğu birbirinden bağımsızdır ve PCA analizi yapılabilir. ancak yinede KBO değerine bakılıp karar verilecektir.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'psych' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'psych'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:Hmisc':

    describe</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:car':

    logit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggplot2':

    %+%, alpha</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">KMO</span>(df[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"age"</span>, <span class="st">"oldpeak"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kaiser-Meyer-Olkin factor adequacy
Call: KMO(r = df[, c("restingBP", "age", "oldpeak", "serumcholestrol", 
    "maxheartrate")])
Overall MSA =  0.53
MSA for each item = 
      restingBP             age         oldpeak serumcholestrol    maxheartrate 
           0.53            0.47            0.50            0.52            0.58 </code></pre>
</div>
</div>
<p>KMO örneklem yeterliliğne göre KMO&gt;0.5 olan değişkenler zayıf ancak kabul edilebilir düzeydedir ancak <strong>age</strong> ve <strong>oldpeak</strong> değişkenleri KMO&lt;0.5 kabul edilemez seviyesinde olduklarından dolayı Temel Bileşenler Analize uygun değildir bu yüzden veri setinden çıkarılıp devam edilmiştir.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 'age' ve 'oldpeak' değişkenlerini çıkararak yeni bir veri seti oluşturuyoruz</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>df_pca <span class="ot">&lt;-</span> df[, <span class="sc">!</span>(<span class="fu">names</span>(df) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"oldpeak"</span>))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="bartlett-küresellik-testi" class="level4">
<h4 class="anchored" data-anchor-id="bartlett-küresellik-testi">Bartlett Küresellik Testi</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Bartlett Küresellik Testi(Bartlett's Test of Spherecity) </span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cortest.bartlett</span>(<span class="fu">cor</span>(df_pca[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>)])) <span class="co">#Bartlett test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cortest.bartlett(cor(df_pca[, c("restingBP", "serumcholestrol", : n
not specified, 100 used</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$chisq
[1] 6.225447

$p.value
[1] 0.1011423

$df
[1] 3</code></pre>
</div>
</div>
<p>Hipotezler:</p>
<ul>
<li><p><strong>H₀ (Null Hipotezi):</strong> Korelasyon matrisi birim matristir (yani değişkenler arasında anlamlı bir korelasyon yoktur).</p></li>
<li><p><strong>H₁ (Alternatif Hipotez):</strong> Korelasyon matrisi birim matris değildir (yani değişkenler arasında anlamlı bir korelasyon vardır).</p></li>
</ul>
<p>p-değeri= 0.1011 &gt; <strong>0.05</strong> olduğundan, <strong>H₀ hipotezi reddedilemez</strong>. Bu, değişkenler arasında <strong>anlamlı bir korelasyon olmadığına</strong> işaret eder.</p>
</section>
<section id="princomp-fonksiyonu" class="level3">
<h3 class="anchored" data-anchor-id="princomp-fonksiyonu">princomp fonksiyonu</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Temel Bilesenler Analizi- princomp fonksiyonu</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>fit.pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>( <span class="sc">~</span>., <span class="at">data=</span>df_pca[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>)], <span class="at">scale=</span><span class="cn">TRUE</span>)</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>fit.pca<span class="sc">$</span>rotation </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      PC1        PC2         PC3
restingBP       0.6457084  0.2718283 -0.71356151
serumcholestrol 0.6385089  0.3202838  0.69980335
maxheartrate    0.4187686 -0.9074842  0.03324514</code></pre>
</div>
</div>
<ul>
<li><p><strong>PC1</strong>:</p>
<ul>
<li><p><strong>restingBP (0.646)</strong> ve <strong>serumcholestrol (0.639)</strong>, birinci bileşene en fazla katkı yapan değişkenlerdir.</p></li>
<li><p><strong>PC1</strong>, bu iki değişkenin ortak varyansını yakalayan bir eksen gibi düşünülebilir.</p></li>
</ul></li>
<li><p><strong>PC2</strong>:</p>
<ul>
<li><strong>maxheartrate (-0.907)</strong>, ikinci bileşene güçlü ve negatif bir katkı yapmaktadır. Bu bileşen, özellikle maxheartrate değişkenini temsil ediyor olabilir.</li>
</ul></li>
<li><p><strong>PC3</strong>:</p>
<ul>
<li><strong>serumcholestrol (0.700)</strong> ve <strong>restingBP (-0.714)</strong>, üçüncü bileşene katkıda bulunurken, maxheartrate bu bileşene düşük katkı sağlamıştır.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Bilesen sayisina karar vermek</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                         PC1    PC2    PC3
Standard deviation     1.132 0.9698 0.8824
Proportion of Variance 0.427 0.3135 0.2595
Cumulative Proportion  0.427 0.7405 1.0000</code></pre>
</div>
</div>
<ul>
<li><p>PC1, toplam varyansın yaklaşık %43’ünü açıklar.</p></li>
<li><p>PC2 ve PC3 birlikte toplam varyansın %57’sini açıklamaktadır.</p></li>
<li><p>İlk iki bileşen, toplam varyansın %74’ünü yakalamaktadır.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>(fit.pca<span class="sc">$</span>sdev)<span class="sc">^</span><span class="dv">2</span> <span class="co">#ozdegerler</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.2809779 0.9404640 0.7785581</code></pre>
</div>
</div>
<p>PC1’in veri setindeki en baskın bileşen olduğunu gösterirken, PC3 en az varyans açıklayan bileşendir.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'factoextra' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>scree <span class="ot">&lt;-</span> <span class="fu">fviz_eig</span>(fit.pca)</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>scree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>PC1</strong>: Toplam varyansın <strong>%42</strong>’sini açıklıyor ve en önemli bileşen olarak öne çıkıyor.</p></li>
<li><p><strong>PC2</strong>: Toplam varyansın <strong>%31</strong>’ini açıklayarak ikinci en önemli bileşen.</p></li>
<li><p><strong>PC3</strong>: Varyansın <strong>%26</strong>’sını açıklıyor ve katkısı daha düşük.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ilk iki bilesene karar verildi:</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>fit.pca<span class="sc">$</span>rotation[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      PC1        PC2
restingBP       0.6457084  0.2718283
serumcholestrol 0.6385089  0.3202838
maxheartrate    0.4187686 -0.9074842</code></pre>
</div>
</div>
<p>Y1= 0.645 restinBP + 0.638 serumcholestrol + 0.418 maxheartrate</p>
<p>Y2= 0.271 restinBP + 0.320 serumcholestrol - 0.907 maxheartrate</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>fit.pca<span class="sc">$</span>rotation[,<span class="dv">2</span>]<span class="sc">*</span>fit.pca<span class="sc">$</span>sdev[<span class="dv">2</span>] <span class="co"># koklambda ile carpılmıs hali bu da bizi faktore goturuyor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      restingBP serumcholestrol    maxheartrate 
      0.2636124       0.3106033      -0.8800558 </code></pre>
</div>
</div>
<ul>
<li><p><strong>restingBP</strong>: <strong>0.26</strong> → PC2 ile pozitif ve orta düzeyde bir ilişki gösteriyor.</p></li>
<li><p><strong>serumcholestrol</strong>: <strong>0.31</strong> → PC2 ile pozitif yönde daha güçlü bir ilişki gösteriyor.</p></li>
<li><p><strong>maxheartrate</strong>: <strong>-0.88</strong> → PC2 ile güçlü ve negatif bir ilişki gösteriyor.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(fit.pca,<span class="at">col.var=</span><span class="st">"steelblue"</span>,</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span> <span class="co"># Avoid text overlapping</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>serumcholestrol</strong> ve <strong>restingBP</strong> değişkenleri <strong>Dim1</strong>’e benzer yönelim göstererek pozitif katkı sağlıyor.</p></li>
<li><p><strong>maxheartrate</strong>, <strong>Dim1</strong>’e ters ve <strong>Dim2</strong>’ye negatif yönde baskın bir yük taşıyor.</p></li>
<li><p>Değişkenler arasında belirgin bir ilişki ve farklılaşma gözleniyor.</p></li>
</ul>
</section>
</section>
<section id="faktör-analizi" class="level1">
<h1><strong>4) Faktör Analizi</strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>df_faktor <span class="ot">&lt;-</span> df_pca</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df_faktor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   patientid       gender  chestpain   restingBP     serumcholestrol
 Min.   : 119250   0:223   0:405     Min.   : 94.0   Min.   : 85.0  
 1st Qu.:2545688   1:724   1:206     1st Qu.:128.0   1st Qu.:248.0  
 Median :4994167           2:293     Median :144.0   Median :326.0  
 Mean   :5081857           3: 43     Mean   :151.1   Mean   :328.9  
 3rd Qu.:7697459                     3rd Qu.:180.5   3rd Qu.:410.0  
 Max.   :9990855                     Max.   :200.0   Max.   :602.0  
 fastingbloodsugar restingrelectro  maxheartrate exerciseangia slope  
 0:651             0:439           Min.   : 71   0:471         0:180  
 1:296             1:324           1st Qu.:118   1:476         1:291  
                   2:184           Median :145                 2:294  
                                   Mean   :145                 3:182  
                                   3rd Qu.:175                        
                                   Max.   :202                        
 noofmajorvessels target 
 0:268            0:420  
 1:325            1:527  
 2:248                   
 3:106                   
                         
                         </code></pre>
</div>
</div>
<section id="korelasyon" class="level4">
<h4 class="anchored" data-anchor-id="korelasyon">Korelasyon</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(df_faktor[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>)]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>korelasyon<span class="ot">&lt;-</span><span class="fu">cor</span>(df_faktor[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>)])</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>korelasyon</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 restingBP serumcholestrol maxheartrate
restingBP       1.00000000      0.22123879   0.09591656
serumcholestrol 0.22123879      1.00000000   0.08728237
maxheartrate    0.09591656      0.08728237   1.00000000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"Hmisc"</span>) <span class="co">#anlamlılık değerleriyle birlikte görmek istersek (2-tailed sonuçlar)</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rcorr</span>(<span class="fu">as.matrix</span>(df_faktor[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>)]),<span class="at">type=</span><span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                restingBP serumcholestrol maxheartrate
restingBP            1.00            0.22         0.10
serumcholestrol      0.22            1.00         0.09
maxheartrate         0.10            0.09         1.00

n= 947 


P
                restingBP serumcholestrol maxheartrate
restingBP                 0.0000          0.0031      
serumcholestrol 0.0000                    0.0072      
maxheartrate    0.0031    0.0072                      </code></pre>
</div>
</div>
<p><strong>Korelasyon Matrisi (r)</strong>:</p>
<ul>
<li><p><strong>restingBP ve serumcholestrol</strong>: Korelasyon değeri 0.22, yani düşük pozitif bir ilişki vardır.</p></li>
<li><p><strong>restingBP ve maxheartrate</strong>: Korelasyon değeri 0.10, çok zayıf bir pozitif ilişki vardır.</p></li>
<li><p><strong>serumcholestrol ve maxheartrate</strong>: Korelasyon değeri 0.09, çok zayıf bir ilişki vardır.</p></li>
</ul>
<p><strong>Anlamlılık P-değerleri (p)</strong>:</p>
<ul>
<li><p><strong>restingBP ve serumcholestrol</strong>: p-değeri 0.0000, bu ilişki istatistiksel olarak anlamlıdır.</p></li>
<li><p><strong>restingBP ve maxheartrate</strong>: p-değeri 0.0031, bu ilişki istatistiksel olarak anlamlıdır.</p></li>
<li><p><strong>serumcholestrol ve maxheartrate</strong>: p-değeri 0.0072, bu ilişki de istatistiksel olarak anlamlıdır.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(matlib)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'matlib' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'matlib'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:psych':

    tr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:heplots':

    gsorth</code></pre>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>invkor<span class="ot">&lt;-</span><span class="fu">inv</span>(korelasyon)<span class="co"># korelasyon matrisinin tersi (VIF)</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(invkor)<span class="ot">&lt;-</span><span class="fu">rownames</span>(invkor)<span class="ot">&lt;-</span><span class="fu">colnames</span>(korelasyon)</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>invkor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 restingBP serumcholestrol maxheartrate
restingBP        1.0580445     -0.22695169  -0.08167510
serumcholestrol -0.2269517      1.05635808  -0.07043302
maxheartrate    -0.0816751     -0.07043302   1.01398156</code></pre>
</div>
</div>
<ul>
<li><p><strong>restingBP</strong> için VIF = 1.058, yani bu değişkenin diğer değişkenlerle doğrusal ilişkisi çok güçlü değil.</p></li>
<li><p><strong>serumcholestrol</strong> için VIF = 1.056, benzer şekilde, bu değişkenin de diğerleriyle doğrusal ilişkisi düşük.</p></li>
<li><p><strong>maxheartrate</strong> için VIF = 1.014, bu da aynı şekilde düşük doğrusal ilişkiyi gösterir.</p></li>
</ul>
</section>
<section id="kmo---anti-image" class="level4">
<h4 class="anchored" data-anchor-id="kmo---anti-image">KMO - Anti-Image</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Faktor Analizi Uygulanabilirligi (KMO - Anti-Image - Bartlett Test)</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="fu">KMO</span>(df_faktor[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>)]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kaiser-Meyer-Olkin factor adequacy
Call: KMO(r = df_faktor[, c("restingBP", "serumcholestrol", "maxheartrate")])
Overall MSA =  0.54
MSA for each item = 
      restingBP serumcholestrol    maxheartrate 
           0.53            0.53            0.61 </code></pre>
</div>
</div>
<p><strong>maxheartrate</strong> için MSA değeri 0.61 olduğu için bu değişken faktör analizine daha uygunken, <strong>restingBP</strong> ve <strong>serumcholestrol</strong> için MSA değerleri 0.53 ile biraz daha düşük kalıyor.</p>
</section>
<section id="bartlett-küresellik-testi-1" class="level4">
<h4 class="anchored" data-anchor-id="bartlett-küresellik-testi-1">Bartlett Küresellik Testi</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Bartlett Küresellik Testi(Bartlett's Test of Spherecity) </span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cortest.bartlett</span>(<span class="fu">cor</span>(df_faktor[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>)]),<span class="fu">nrow</span>(df_faktor[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>)])) <span class="co">#Bartlett test </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$chisq
[1] 60.49255

$p.value
[1] 4.613272e-13

$df
[1] 3</code></pre>
</div>
</div>
<ul>
<li><p><strong>Hipotezler</strong>:</p>
<ul>
<li><p><strong>H₀ (Null Hipotezi)</strong>: Korelasyon matrisinin birim matris olduğu, yani değişkenler arasında bir ilişkilerin olmadığı varsayılır.</p></li>
<li><p><strong>H₁ (Alternatif Hipotezi)</strong>: Korelasyon matrisinin birim matris olmadığı, yani değişkenler arasında ilişkilerin bulunduğu varsayılır.</p>
<p>p-değeri =(4.61 × 10⁻¹³)&lt; 0.05 olduğundan, <strong>H₀</strong> <strong>reddedilir</strong>.</p></li>
</ul></li>
</ul>
</section>
<section id="kok-lambda-yaklasimi" class="level4">
<h4 class="anchored" data-anchor-id="kok-lambda-yaklasimi">Kok lambda yaklasimi</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Temel Bilesenler Analizi Yöntemi(Kok lambda yaklasimi) secilerek faktor analizi</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>fa_kokl <span class="ot">&lt;-</span> <span class="fu">principal</span>(df_faktor[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>)], <span class="at">nfactors =</span><span class="dv">3</span>, <span class="at">rotate =</span> <span class="st">"none"</span>)</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_kokl<span class="sc">$</span>loadings, <span class="at">digits=</span><span class="dv">3</span>, <span class="at">cutoff=</span>.<span class="dv">3</span>, <span class="at">sort=</span><span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
                PC1    PC2    PC3   
restingBP        0.731        -0.630
serumcholestrol  0.723 -0.311  0.617
maxheartrate     0.474  0.880       

                 PC1   PC2   PC3
SS loadings    1.281 0.940 0.779
Proportion Var 0.427 0.313 0.260
Cumulative Var 0.427 0.740 1.000</code></pre>
</div>
</div>
<ul>
<li><p><strong>PC1</strong> yüksek varyansa sahip ve <em>restingBP</em> ve <em>serumcholestrol</em> ile güçlü bir ilişki gösteriyor.</p></li>
<li><p><strong>PC2</strong> de yüksek varyansa sahip ve özellikle <em>maxheartrate</em> ile güçlü bir ilişki göstermektedir.</p></li>
<li><p><strong>PC3</strong> daha düşük varyansa sahip ve <em>serumcholestrol</em> ile ilişkili.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(fa_kokl<span class="sc">$</span>loadings[ , ]<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">9</span> <span class="co">#varyans aciklama oranlari (yukarıdaki fonksiyon çıktılarında da var)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       PC1        PC2        PC3 
0.14233087 0.10449600 0.08650646 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fa_kokl<span class="sc">$</span>values, <span class="at">type=</span><span class="st">"b"</span>, <span class="at">main=</span><span class="st">"ScreePlot"</span>, <span class="at">xlab=</span><span class="st">"Number of Factors"</span>, <span class="at">ylab=</span><span class="st">"Eigenvalues"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>özdeğerlerdeki düşüşün ilk ve ikinci faktörler arasında keskin olduğunu, ardından daha kademeli bir düşüş olduğunu gösteriyor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co">#caused cıkarılıyor</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>fa_kokl11 <span class="ot">&lt;-</span> <span class="fu">principal</span>(df_faktor[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>)], <span class="at">nfactors =</span><span class="dv">3</span>, <span class="at">rotate =</span> <span class="st">"none"</span>)</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_kokl11<span class="sc">$</span>loadings, <span class="at">digits=</span><span class="dv">3</span>, <span class="at">cutoff=</span>.<span class="dv">3</span>, <span class="at">sort=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
                PC1    PC2    PC3   
restingBP        0.731        -0.630
serumcholestrol  0.723 -0.311  0.617
maxheartrate     0.474  0.880       

                 PC1   PC2   PC3
SS loadings    1.281 0.940 0.779
Proportion Var 0.427 0.313 0.260
Cumulative Var 0.427 0.740 1.000</code></pre>
</div>
</div>
<ul>
<li><p><strong>PC1</strong>: <em>restingBP</em> ve <em>serumcholestrol</em> ile yüksek pozitif ilişki (0.731 ve 0.723) gösteriyor. Bu, bu iki değişkenin bir arada hareket ettiğini ve birincil bileşenin bu iki değişkeni temsil ettiğini gösteriyor.</p></li>
<li><p><strong>PC2</strong>: <em>restingBP</em> negatif yük (–0.630) ile <em>maxheartrate</em> yüksek pozitif yük (0.880) ile ilişkilendirilmiş. Bu, PC2’nin bu iki değişkenin zıt yönlerde hareket ettiğini gösteriyor.</p></li>
<li><p><strong>PC3</strong>: <em>serumcholestrol</em> ile pozitif bir ilişki (0.617) var. Diğer değişkenlerle çok güçlü bir ilişki göstermiyor, bu da üçüncü bileşenin daha düşük varyans açıklamasına neden oluyor.</p></li>
</ul>
</section>
<section id="section" class="level4">
<h4 class="anchored" data-anchor-id="section"></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.diagram</span>(fa_kokl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>PC1</strong>, hem restingBP (0.7) hem de serumcholestrol (0.7) tarafından orta düzeyde etkilenmektedir.</p></li>
<li><p><strong>PC2</strong>, öncelikle maxheartrate (0.9) tarafından yüklenmiştir.</p></li>
<li><p><strong>PC3</strong>’ün kayda değer bir yükü bulunmamaktadır.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>fyuk <span class="ot">&lt;-</span> fa_kokl<span class="sc">$</span>loadings[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]<span class="co">#degiskenlerin faktor yukleri</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scatterplot3d)</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>s3d <span class="ot">&lt;-</span> <span class="fu">scatterplot3d</span>(<span class="fu">as.data.frame</span>(<span class="fu">unclass</span>(fyuk)), <span class="at">main=</span><span class="st">"3D factor loadings"</span>, <span class="at">color=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(df_faktor[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>)][,<span class="sc">-</span><span class="dv">4</span>]), <span class="at">pch=</span><span class="dv">20</span>)</span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(s3d<span class="sc">$</span><span class="fu">xyz.convert</span>(fyuk), <span class="at">labels =</span> <span class="fu">rownames</span>(fyuk),</span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex=</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(df_faktor[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>)][,<span class="sc">-</span><span class="dv">4</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>restingBP</strong>, temel olarak PC1 ekseni boyunca hizalanmıştır.</p></li>
<li><p><strong>serumcholestrol</strong> ve <strong>maxheartrate</strong> değişkenlerinin yük vektörleri PC1 ve PC2 eksenleri arasında yer almaktadır.</p></li>
<li><p>PC3 üzerine güçlü bir şekilde yüklenen bir değişken yoktur, bu da bu bileşenin çok az varyansı açıkladığını doğrular.</p></li>
</ul>
</section>
</section>
<section id="lineer-diskriminant-analizi" class="level1">
<h1>5) Lineer Diskriminant Analizi</h1>
<p>Bu analizde, bağımsız değişkenler olarak “restingBP”, “age”, “serumcholestrol” ve “maxheartrate”, bağımlı değişken olarak ise “target” kullanılmıştır. Korelasyon analizi yapılarak, bağımsız değişkenler arasındaki ilişkiler incelenmiştir. Ayrıca, verinin normalliği kontrol edilerek, verilerin normal dağılıma uygun olduğu kararı verilmiştir.</p>
<section id="korelasyon-ve-normallık-incelemeleri" class="level4">
<h4 class="anchored" data-anchor-id="korelasyon-ve-normallık-incelemeleri">Korelasyon ve normallık incelemeleri</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 'target' dahil, ancak sadece diğer değişkenlerin korelasyonuna bakma</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>df_dis <span class="ot">&lt;-</span> df[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"age"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>, <span class="st">"target"</span>)]</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Korelasyon hesaplama (Spearman yöntemiyle), sadece ilk dört sütun</span></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(df_dis[,<span class="sc">-</span><span class="fu">ncol</span>(df_dis)], <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Korelasyon matrisini görselleştirme</span></span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, <span class="at">method =</span> <span class="st">"number"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Görseldeki korelasyon analizine göre, değişkenler arasında belirgin güçlü bir ilişki gözlemlenmemektedir. Bu, çoklu bağlantı (multicollinearity) sorununun olmadığı ve dolayısıyla analizlere devam edilebileceği anlamına gelmektedir.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Multivariate Normality</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>df_dis <span class="sc">%&gt;%</span> </span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(target)) <span class="sc">%&gt;%</span></span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mshapiro_test</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  statistic p.value
      &lt;dbl&gt;   &lt;dbl&gt;
1     0.997  0.0544</code></pre>
</div>
</div>
<p>Hipotez:</p>
<ul>
<li><p><strong>H0 (null hipotezi)</strong>: Veri normal dağılıma uygundur.</p></li>
<li><p><strong>H1 (alternatif hipotez)</strong>: Veri normal dağılıma uygun değildir.</p></li>
</ul>
<p>p-değeri = 0.0544 &gt; 0.05 H0 <strong>Reddedilemez</strong>, yani verinin normal dağıldığı söylenebilir.</p>
<p>veri normal dağıldığı için analize devam edildi.</p>
</section>
<section id="homogeneity-of-covariances-1" class="level4">
<h4 class="anchored" data-anchor-id="homogeneity-of-covariances-1">Homogeneity of Covariances</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Homogeneity of Covariances</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(biotools)</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxM</span>(df_dis[,<span class="sc">-</span><span class="dv">5</span>], df_dis<span class="sc">$</span>target)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box's M-test for Homogeneity of Covariance Matrices

data:  df_dis[, -5]
Chi-Sq (approx.) = 100.76, df = 10, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Hipotez:</p>
<p>H0 : sınıfların varyans kovaryans matrislero eşittir (homojenlik)</p>
<p>H1 : sınıfların varyans Kovaryans matrisleri eşit değildir (homojenlik)</p>
<p>2.2e-16 &lt; 0.05 <strong>H0 reddedilir</strong> yani homojen değildir.</p>
</section>
<section id="linear-discriminant-analysis---binary-class" class="level4">
<h4 class="anchored" data-anchor-id="linear-discriminant-analysis---binary-class">Linear Discriminant Analysis - Binary-class</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Linear Discriminant Analysis - Binary-class</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="co"># LDA modelini oluşturma</span></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>lda_model <span class="ot">&lt;-</span> <span class="fu">lda</span>(target <span class="sc">~</span> restingBP <span class="sc">+</span> age <span class="sc">+</span> serumcholestrol <span class="sc">+</span> maxheartrate, <span class="at">data =</span> df_dis)</span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Modeli görüntüleme</span></span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>lda_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
lda(target ~ restingBP + age + serumcholestrol + maxheartrate, 
    data = df_dis)

Prior probabilities of groups:
        0         1 
0.4435058 0.5564942 

Group means:
  restingBP      age serumcholestrol maxheartrate
0  134.7690 49.06667        281.0595     136.3071
1  164.0664 49.48767        366.9867     151.9450

Coefficients of linear discriminants:
                        LD1
restingBP       0.028711777
age             0.001668793
serumcholestrol 0.005095363
maxheartrate    0.009995139</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sabit terimi (constant) hesaplama</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>cons <span class="ot">&lt;-</span> <span class="fu">apply</span>(df_dis[,<span class="sc">-</span><span class="dv">5</span>], <span class="dv">2</span>, mean)</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sabit terim ile LDA'nın scaling matrisini çarpma</span></span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>(<span class="sc">-</span>cons) <span class="sc">%*%</span> (lda_model<span class="sc">$</span>scaling)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           LD1
[1,] -7.544984</code></pre>
</div>
</div>
<p>Diskriminant fomksiyonu :</p>
<p>Y= -7.544 +0.0287 restingBP -0.00166 age -0.0050 serumcholestrol + 0.00999 maxheartrate</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Grup tahmini yapilmasi</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>lda_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lda_model)</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>lda_pred<span class="sc">$</span>class <span class="co"># Sinifatamalari </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 0 0 0 0 1 0 1 1 1 0 0 1 0 1 1 0 1 1 0 1 1 0 1 1 1 0 1 1 1 0 0 1 1 0 0 1 0
 [38] 1 1 1 0 0 1 0 0 0 1 1 1 1 1 0 1 0 0 1 1 0 0 1 1 1 1 0 1 0 1 1 1 1 1 0 1 1
 [75] 0 0 1 0 1 1 0 1 1 1 1 1 1 1 0 0 1 1 0 1 1 1 0 0 0 1 1 1 0 0 0 0 1 1 0 0 1
[112] 0 0 1 1 0 0 0 1 1 1 0 1 1 1 0 1 1 0 0 1 1 0 1 1 1 0 0 0 1 1 1 0 0 1 0 1 0
[149] 1 1 1 1 0 0 1 1 1 1 0 1 0 1 1 1 1 0 0 0 1 1 1 0 1 1 1 1 1 1 1 1 0 0 0 1 1
[186] 1 1 1 0 1 1 0 0 1 1 1 1 1 0 1 0 1 1 1 1 0 0 1 0 1 1 0 1 1 0 0 1 1 1 1 1 0
[223] 0 1 1 0 1 1 0 0 1 1 0 1 1 0 1 0 0 0 1 1 0 1 1 0 1 1 1 1 1 1 0 0 1 0 1 0 1
[260] 0 1 1 1 1 1 0 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 1 1 0 1 1 0 1 1 1 1 0 0 0
[297] 0 0 1 0 1 1 1 1 0 0 1 0 1 0 0 1 0 1 1 1 1 1 0 1 1 1 1 1 1 0 0 0 0 1 0 1 0
[334] 1 0 1 1 0 0 1 0 0 1 1 0 1 0 1 0 1 1 1 1 1 0 1 1 0 1 0 1 1 0 1 1 1 0 0 1 0
[371] 0 0 1 0 0 1 0 0 1 0 1 0 0 1 0 1 1 0 1 1 1 1 1 1 0 0 0 1 1 1 1 0 1 1 1 1 0
[408] 0 1 1 1 1 0 1 0 1 0 0 1 1 0 1 1 1 1 0 1 1 0 0 1 1 1 0 0 0 0 1 0 1 1 1 1 1
[445] 1 1 1 0 1 0 0 1 1 0 0 1 0 1 1 0 1 0 1 0 0 0 0 0 0 1 1 0 0 0 1 1 1 0 1 0 1
[482] 1 0 0 1 1 0 0 1 0 0 0 1 1 0 0 0 0 0 1 1 1 1 0 1 0 1 0 1 0 1 1 0 1 1 0 1 0
[519] 1 0 0 1 1 1 0 0 1 0 1 1 1 1 1 1 1 0 1 0 0 0 0 1 0 1 1 0 1 0 1 1 1 0 1 0 1
[556] 1 1 0 1 1 1 1 1 1 0 1 0 1 0 0 1 1 0 1 1 1 1 1 0 1 0 1 1 0 1 1 0 0 1 0 0 1
[593] 1 1 1 0 1 1 0 0 0 0 0 0 0 1 0 0 0 0 0 1 1 0 1 0 0 0 1 1 1 0 1 0 0 1 1 0 0
[630] 0 1 0 1 0 1 0 1 1 0 1 1 0 0 0 1 1 1 1 0 0 1 1 0 0 1 1 0 1 0 1 0 0 1 1 1 1
[667] 1 1 0 1 1 0 1 0 1 1 1 1 0 1 1 1 0 0 0 1 0 0 0 0 1 1 0 1 0 1 0 1 0 1 1 0 1
[704] 1 0 0 1 0 1 0 1 0 0 0 1 1 0 1 1 0 0 1 1 0 0 0 0 0 0 1 0 1 1 1 0 0 0 0 0 0
[741] 0 1 0 1 1 1 0 1 1 0 1 0 0 1 1 1 0 0 1 0 0 1 0 0 1 1 1 1 1 0 1 1 0 0 1 1 0
[778] 0 0 0 0 0 0 0 0 1 1 0 1 0 1 1 1 1 0 1 1 1 0 0 0 0 0 1 1 1 1 0 1 1 0 0 0 0
[815] 1 1 1 0 0 1 1 0 0 1 1 1 1 1 1 1 0 1 1 0 1 1 1 1 1 1 1 1 1 0 1 1 0 1 1 0 1
[852] 1 1 1 0 0 1 1 1 1 1 0 0 0 1 0 0 1 0 1 0 1 1 1 1 1 0 0 0 1 1 0 1 1 1 1 1 0
[889] 0 1 1 1 1 1 1 0 1 0 0 0 0 1 0 0 0 1 0 1 1 0 1 1 1 1 1 1 0 1 1 0 1 0 1 1 0
[926] 1 0 1 1 0 1 1 0 1 0 1 0 0 1 1 1 0 1 0 1 1 1
Levels: 0 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Diskriminant skorları için</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lda_pred$x</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plots</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ldahist</span>(lda_pred<span class="sc">$</span>x, <span class="at">g =</span> df_dis<span class="sc">$</span>target)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>group 0 için :</p>
<p>&nbsp;Bu histogramda verilerin büyük çoğunluğunun -2 ile 1 aralığında ve biraz daha çok -1 ile 0 arasında yoğunlaştığı görülüyor. Ayrıca, histogramın sağ tarafında küçük bir grup daha var.</p>
<p>group 1 için:</p>
<p>Verilerin büyük çoğunluğu -1 ile 2 aralığında ve özellikle 0 ile 1 aralığında yoğunlaşmış durumda.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Çapraz tablo oluşturma</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>tablo <span class="ot">&lt;-</span> <span class="fu">table</span>(df_dis<span class="sc">$</span>target, lda_pred<span class="sc">$</span>class)</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>tablo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
      0   1
  0 303 117
  1 101 426</code></pre>
</div>
</div>
<p>model <strong>0</strong> sınıfı için 303 doğru tahmin yaparken, 117 yanlış tahmin yapmış. <strong>1</strong> sınıfı için ise 426 doğru tahmin yaparken, 101 yanlış tahmin yapmış. Bu sonuç, modelin her iki sınıfı da oldukça iyi ayırt ettiğini gösteriyor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Dogru siniflanma orani</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>classrate<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">diag</span>(tablo))<span class="sc">/</span><span class="fu">sum</span>(tablo)</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>classrate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7697994</code></pre>
</div>
</div>
<p>Doğru sınıflandırma oranı <strong>0.7698</strong> (yaklaşık %77) olarak hesaplanmıştır.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nispi sans kriteri p1^2+p^2</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>lda_model<span class="sc">$</span>prior[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> lda_model<span class="sc">$</span>prior[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        0 
0.5063832 </code></pre>
</div>
</div>
<p>Bu, modelin doğru sınıflandırma şansının <strong>yaklaşık %51</strong> olduğunu gösterir.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Orjinal gruplar ile Tahmin edilen grupların karşılaştırılması</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>comp <span class="ot">&lt;-</span> <span class="fu">cbind</span>(df_dis<span class="sc">$</span>target, lda_pred<span class="sc">$</span>class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Stepwise </span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(klaR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'klaR' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>stepwise_model <span class="ot">&lt;-</span> <span class="fu">greedy.wilks</span>(target <span class="sc">~</span> ., <span class="at">data =</span> df_dis)</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>stepwise_model<span class="sc">$</span>results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             vars Wilks.lambda F.statistics.overall p.value.overall
1       restingBP    0.7654467             289.5732    7.539206e-57
2 serumcholestrol    0.6884644             213.5837    3.020456e-77
3    maxheartrate    0.6624373             160.1770    6.673905e-84
  F.statistics.diff p.value.diff
1         289.57319 7.539206e-57
2         105.55560 0.000000e+00
3          37.05043 1.672094e-09</code></pre>
</div>
</div>
<p><strong>Anova için yorum :</strong></p>
<ul>
<li><p><strong>H₀ (Null Hipotezi)</strong>: İncelenen bağımsız değişkenlerin, bağımlı değişken üzerinde anlamlı bir etkisi yoktur.</p></li>
<li><p><strong>H₁ (Alternatif Hipotez)</strong>: Bağımsız değişkenlerin, bağımlı değişken üzerinde anlamlı bir etkisi vardır.</p></li>
<li><p><strong>p değeri =</strong> <strong>7.54e-57&lt; 0.05 H0 Red</strong> : Bu, <strong>restingBP</strong> değişkeninin gruplar arasında anlamlı farklar yarattığını gösteriyor.</p></li>
<li><p><strong>p değeri = 3.02e-77 &lt; 0.05 H₀</strong> <strong>Red</strong>: Bu, <strong>serumcholestrol</strong> değişkeninin gruplar arasında anlamlı farklar yarattığını gösteriyor.</p></li>
<li><p><strong>p değeri = 6.67e-84 &lt; 0.05 H₀</strong> <strong>Red</strong>: Bu, <strong>maxheartrate</strong> değişkeninin gruplar arasında anlamlı farklar yarattığını gösteriyor.</p></li>
</ul>
<p><strong>Wilks’ Lambda yorumu :</strong></p>
<p>Wilks’ Lambda değeri <strong>maxheartrate</strong> için en düşük olan değere sahip, yani <strong>0.6624373</strong>. Bu, <strong>maxheartrate</strong> değişkeninin gruplar arasındaki ayrımda en kuvvetli ve en anlamlı değişken olduğunu gösteriyor.</p>
</section>
</section>
<section id="kümeleme-analizi" class="level1">
<h1>6) Kümeleme Analizi</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dendextend) <span class="co"># dendrogram lara arti ozellikler getirir</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dendextend' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
---------------------
Welcome to dendextend version 1.19.0
Type citation('dendextend') for how to cite the package.

Type browseVignettes(package = 'dendextend') for the package vignette.
The github page is: https://github.com/talgalili/dendextend/

Suggestions and bug-reports can be submitted at: https://github.com/talgalili/dendextend/issues
You may ask questions at stackoverflow, use the r and dendextend tags: 
     https://stackoverflow.com/questions/tagged/dendextend

    To suppress this message use:  suppressPackageStartupMessages(library(dendextend))
---------------------</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dendextend'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    cutree</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>df_kum <span class="ot">&lt;-</span> df[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"age"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>)]</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>df_kum <span class="ot">&lt;-</span> <span class="fu">scale</span>(df_kum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(df_kum[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"age"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>)]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>korelasyon<span class="ot">&lt;-</span><span class="fu">cor</span>(df_kum[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"age"</span>, <span class="st">"serumcholestrol"</span>, <span class="st">"maxheartrate"</span>)])</span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>korelasyon</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  restingBP         age serumcholestrol maxheartrate
restingBP        1.00000000 -0.01241872      0.22123879   0.09591656
age             -0.01241872  1.00000000      0.03418420  -0.04092131
serumcholestrol  0.22123879  0.03418420      1.00000000   0.08728237
maxheartrate     0.09591656 -0.04092131      0.08728237   1.00000000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Korelasyon matrisinin incelenmesi</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"Hmisc"</span>)</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rcorr</span>(<span class="fu">as.matrix</span>(df_kum),<span class="at">type=</span><span class="st">"pearson"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                restingBP   age serumcholestrol maxheartrate
restingBP            1.00 -0.01            0.22         0.10
age                 -0.01  1.00            0.03        -0.04
serumcholestrol      0.22  0.03            1.00         0.09
maxheartrate         0.10 -0.04            0.09         1.00

n= 947 


P
                restingBP age    serumcholestrol maxheartrate
restingBP                 0.7027 0.0000          0.0031      
age             0.7027           0.2933          0.2083      
serumcholestrol 0.0000    0.2933                 0.0072      
maxheartrate    0.0031    0.2083 0.0072                      </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hiyerarsik Kümeleme</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(df_kum, <span class="at">method =</span> <span class="st">"euclidean"</span>) <span class="co"># uzaklik matrisi</span></span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d, <span class="at">method=</span><span class="st">"ward.D"</span>) <span class="co"># method= "single", "complete", "average", "ward.D", "centroid"</span></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>dend<span class="ot">&lt;-</span><span class="fu">as.dendrogram</span>(fit) <span class="co"># Dendogram çizimi</span></span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dend)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">color_branches</span>(dend, <span class="at">k=</span><span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="k-means" class="level4">
<h4 class="anchored" data-anchor-id="k-means">K-MEANS</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="do">############     K-MEANS #############</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(df_kum, kmeans, <span class="at">method =</span> <span class="st">"wss"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(df_kum, kmeans, <span class="at">method =</span> <span class="st">"silhouette"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">95739487</span>) </span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>km.res <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df_kum,<span class="dv">3</span>, <span class="at">iter.max=</span><span class="dv">10</span>, <span class="at">algorithm=</span><span class="st">"Lloyd"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: did not converge in 10 iterations</code></pre>
</div>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(km.res<span class="sc">$</span>centers)  <span class="co">#Cluster means = SPSS'teki Final Cluster Centers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          1          2           3
restingBP       -0.58013458 0.82514033 -0.51952715
age             -0.03065695 0.08126766 -0.07898654
serumcholestrol -0.41035209 0.72041993 -0.55460900
maxheartrate    -1.06581834 0.18638754  0.86466519</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Ilk iki faktörün cizdirilmesi</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'cluster' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clusplot</span>(df_kum, km.res<span class="sc">$</span>cluster, <span class="at">main=</span><span class="st">'2D representation of the Cluster solution'</span>,</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">color=</span><span class="cn">TRUE</span>, <span class="at">shade=</span><span class="cn">TRUE</span>,</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels=</span><span class="dv">2</span>, <span class="at">lines=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ya da bu fonksiyonla Temel Bileşenlere Göre</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km.res, <span class="at">data =</span> df_kum, <span class="at">palette =</span> <span class="st">"jco"</span>,</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="lojistik-regresyon" class="level1">
<h1>7) <strong>Lojistik Regresyon</strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(tidyverse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyverse' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lubridate' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(modelr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'modelr' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(broom))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="do">###Uygulama-1: Binary Logistic Regression-Skulls Data</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>df_log <span class="ot">=</span> df_dis <span class="ot">&lt;-</span> df[, <span class="fu">c</span>(<span class="st">"restingBP"</span>, <span class="st">"age"</span>, <span class="st">"serumcholestrol"</span>,<span class="st">"maxheartrate"</span>, <span class="st">"target"</span>)]</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Korelasyon hesaplama (Spearman yöntemiyle), sadece ilk dört sütun</span></span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(df_log[,<span class="sc">-</span><span class="fu">ncol</span>(df_dis)], <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Korelasyon matrisini görselleştirme</span></span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, <span class="at">method =</span> <span class="st">"number"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Logistic Regresyon </span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>model_target <span class="ot">&lt;-</span> <span class="fu">glm</span>(target <span class="sc">~</span>restingBP<span class="sc">+</span>age<span class="sc">+</span>serumcholestrol<span class="sc">+</span>maxheartrate, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> df_log)</span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_target)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = target ~ restingBP + age + serumcholestrol + maxheartrate, 
    family = "binomial", data = df_log)

Coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)     -9.7521251  0.7210517 -13.525  &lt; 2e-16 ***
restingBP        0.0373320  0.0030650  12.180  &lt; 2e-16 ***
age              0.0021787  0.0045322   0.481    0.631    
serumcholestrol  0.0070382  0.0007955   8.848  &lt; 2e-16 ***
maxheartrate     0.0140707  0.0024381   5.771 7.87e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1300.7  on 946  degrees of freedom
Residual deviance:  926.9  on 942  degrees of freedom
AIC: 936.9

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="do">### SPSS OBND0MUS TESTS OF MODEL COEFFD0CD0ENTS TABLOSU  </span><span class="al">###</span></span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Ki-kare istatistginin hesabi</span></span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a>model_target<span class="sc">$</span>deviance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 926.9001</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>model_target<span class="sc">$</span>null.deviance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1300.705</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>kikare<span class="ot">&lt;-</span> model_target<span class="sc">$</span>null.deviance<span class="sc">-</span>model_target<span class="sc">$</span>deviance</span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>kikare</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 373.8051</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co">#serbestlik derecesi hesabi</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>model_target<span class="sc">$</span>df.null</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 946</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>model_target<span class="sc">$</span>df.residual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 942</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span>model_target<span class="sc">$</span>df.null<span class="sc">-</span>model_target<span class="sc">$</span>df.residual</span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Ki kare istatistigine ait p degerinin hesabi (p&lt;0.05 ise eklenen degiskenlerin modele katkisi anlamlidir.)</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>kikare.p<span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(kikare,df)</span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>kikare.p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="do">###Hoshmer Lemeshov hesabi (p&gt;0.05 ise model anlamlD1dD1r. yani model veriye uyumludur.)</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ResourceSelection)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ResourceSelection' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ResourceSelection 0.3-6      2023-06-27</code></pre>
</div>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hoslem.test</span>(model_target<span class="sc">$</span>y,<span class="fu">fitted</span>(model_target))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hosmer and Lemeshow goodness of fit (GOF) test

data:  model_target$y, fitted(model_target)
X-squared = 23.068, df = 8, p-value = 0.003278</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Modelin R^2 degerlerinin hesabi </span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"DescTools"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'DescTools' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'DescTools':
  method         from  
  reorder.factor gplots</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'DescTools'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:matlib':

    Dot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:psych':

    AUC, ICC, SD</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:Hmisc':

    %nin%, Label, Mean, Quantile</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:car':

    Recode</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:gplots':

    reorder.factor</code></pre>
</div>
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PseudoR2</span>(model_target, <span class="at">which =</span> <span class="fu">c</span>(<span class="st">"CoxSnell"</span>,<span class="st">"Nagelkerke"</span>,<span class="st">"McFadden"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  CoxSnell Nagelkerke   McFadden 
 0.3261350  0.4367211  0.2873865 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Model katsayilarinin exponential alinmis hali ve güven araliklari</span></span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(model_target))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    (Intercept)       restingBP             age serumcholestrol    maxheartrate 
   5.817092e-05    1.038038e+00    1.002181e+00    1.007063e+00    1.014170e+00 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">confint.default</span>(model_target,<span class="at">level =</span> <span class="fl">0.95</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       2.5 %       97.5 %
(Intercept)     1.415616e-05 0.0002390376
restingBP       1.031820e+00 1.0442921310
age             9.933182e-01 1.0111230853
serumcholestrol 1.005494e+00 1.0086343631
maxheartrate    1.009335e+00 1.0190279421</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Atama Tablosu</span></span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>type_pred<span class="ot">&lt;-</span><span class="fu">fitted</span>(model_target)</span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a>typefac<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(type_pred<span class="sc">&gt;</span><span class="fl">0.5</span>,<span class="st">"B"</span>,<span class="st">"A"</span>)</span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a>t_tab <span class="ot">&lt;-</span> <span class="fu">table</span>(df_log<span class="sc">$</span>target, typefac)</span>
<span id="cb291-5"><a href="#cb291-5" aria-hidden="true" tabindex="-1"></a>t_tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   typefac
      A   B
  0 302 118
  1  98 429</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Toplam Dogru Atanma Yüzdesi</span></span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">diag</span>(t_tab)) <span class="sc">/</span> <span class="fu">sum</span>(t_tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7719113</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Atama Tablosu Görselleştirme</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cvms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'cvms' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)    <span class="co"># tidy()</span></span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)   <span class="co"># tibble()</span></span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>datatib <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"target"</span> <span class="ot">=</span> df_log<span class="sc">$</span>target,<span class="st">"prediction"</span> <span class="ot">=</span> typefac)</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-6"><a href="#cb297-6" aria-hidden="true" tabindex="-1"></a>basic_table <span class="ot">&lt;-</span> <span class="fu">table</span>(datatib)</span>
<span id="cb297-7"><a href="#cb297-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-8"><a href="#cb297-8" aria-hidden="true" tabindex="-1"></a>cfm <span class="ot">&lt;-</span> <span class="fu">tidy</span>(basic_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'tidy.table' is deprecated.
Use 'tibble::as_tibble()' instead.
See help("Deprecated")</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_confusion_matrix</span>(cfm, </span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">target_col =</span> <span class="st">"target"</span>, </span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">prediction_col =</span> <span class="st">"prediction"</span>,</span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">counts_col =</span> <span class="st">"n"</span>,</span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">add_normalized =</span> <span class="cn">FALSE</span>,</span>
<span id="cb299-6"><a href="#cb299-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">add_row_percentages =</span> <span class="cn">FALSE</span>,</span>
<span id="cb299-7"><a href="#cb299-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">font_col_percentages=</span> <span class="fu">font</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb299-8"><a href="#cb299-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">font_counts =</span> <span class="fu">font</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb299-9"><a href="#cb299-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tile_border_color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb299-10"><a href="#cb299-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Gercek"</span>)<span class="sc">+</span></span>
<span id="cb299-11"><a href="#cb299-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Tahmin"</span>)<span class="sc">+</span></span>
<span id="cb299-12"><a href="#cb299-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>,<span class="at">face=</span><span class="st">"bold"</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>,<span class="at">face=</span><span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot_confusion_matrix(cfm, target_col = "target", prediction_col =
"prediction", : 'ggimage' is missing. Will not plot arrows and zero-shading.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot_confusion_matrix(cfm, target_col = "target", prediction_col =
"prediction", : 'rsvg' is missing. Will not plot arrows and zero-shading.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Advanced_Multivariate_Statistical_Analysis_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Stepwise Yöntemler ile Lojistik Regresyon</span></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(MASS))</span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a>step_model<span class="ot">&lt;-</span><span class="fu">step</span>(model_target,<span class="at">direction=</span><span class="st">"both"</span>) <span class="co">#direction=c("backward","forward","both") </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=936.9
target ~ restingBP + age + serumcholestrol + maxheartrate

                  Df Deviance     AIC
- age              1   927.13  935.13
&lt;none&gt;                 926.90  936.90
- maxheartrate     1   962.16  970.16
- serumcholestrol  1  1017.62 1025.62
- restingBP        1  1115.18 1123.18

Step:  AIC=935.13
target ~ restingBP + serumcholestrol + maxheartrate

                  Df Deviance     AIC
&lt;none&gt;                 927.13  935.13
+ age              1   926.90  936.90
- maxheartrate     1   962.24  968.24
- serumcholestrol  1  1018.25 1024.25
- restingBP        1  1115.21 1121.21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a>step_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = target ~ restingBP + serumcholestrol + maxheartrate, 
    family = "binomial", data = df_log)

Coefficients:
    (Intercept)        restingBP  serumcholestrol     maxheartrate  
      -9.637820         0.037294         0.007051         0.014033  

Degrees of Freedom: 946 Total (i.e. Null);  943 Residual
Null Deviance:      1301 
Residual Deviance: 927.1    AIC: 935.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(step_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = target ~ restingBP + serumcholestrol + maxheartrate, 
    family = "binomial", data = df_log)

Coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)     -9.6378199  0.6784670 -14.205  &lt; 2e-16 ***
restingBP        0.0372938  0.0030625  12.178  &lt; 2e-16 ***
serumcholestrol  0.0070510  0.0007953   8.866  &lt; 2e-16 ***
maxheartrate     0.0140326  0.0024362   5.760 8.41e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1300.71  on 946  degrees of freedom
Residual deviance:  927.13  on 943  degrees of freedom
AIC: 935.13

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(step_model<span class="sc">$</span>coefficients)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    (Intercept)       restingBP serumcholestrol    maxheartrate 
   6.521508e-05    1.037998e+00    1.007076e+00    1.014132e+00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">confint.default</span>(step_model,<span class="at">level =</span> <span class="fl">0.95</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       2.5 %       97.5 %
(Intercept)     1.725186e-05 0.0002465245
restingBP       1.031786e+00 1.0442470788
serumcholestrol 1.005507e+00 1.0086469669
maxheartrate    1.009301e+00 1.0189854909</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Atama Tablosu</span></span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>type_pred2<span class="ot">&lt;-</span><span class="fu">fitted</span>(step_model)</span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a>typefac2<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(type_pred<span class="sc">&gt;</span><span class="fl">0.5</span>,<span class="st">"B"</span>,<span class="st">"A"</span>)</span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a>t_tab2 <span class="ot">&lt;-</span> <span class="fu">table</span>(df_log<span class="sc">$</span>target, typefac)</span>
<span id="cb312-5"><a href="#cb312-5" aria-hidden="true" tabindex="-1"></a>t_tab2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   typefac
      A   B
  0 302 118
  1  98 429</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>